# Changelog

## [Phase 3] - 2025-01-XX

### –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –§–∞–∑–∞ 3: –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏ –µ–¥–∏–Ω—ã–π RR-–¥–≤–∏–∂–æ–∫

#### üîß –ó–∞–¥–∞—á–∞ 1: –í—ã–Ω–µ—Å–µ–Ω–∞ –æ–±—â–∞—è RR-–ª–æ–≥–∏–∫–∞ –≤ —Ö–µ–ª–ø–µ—Ä

**–°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `backtester/domain/rr_utils.py`:**
- –§—É–Ω–∫—Ü–∏—è `apply_rr_logic()` - –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞ TP/SL/timeout –¥–ª—è –≤—Å–µ—Ö RR-—Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –§—É–Ω–∫—Ü–∏—è `check_candle_quality()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π
- –§—É–Ω–∫—Ü–∏—è `calculate_volatility_around_entry()` - —Ä–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- –§—É–Ω–∫—Ü–∏—è `calculate_signal_to_entry_delay()` - —Ä–∞—Å—á–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—Ö–æ–¥–∞

**–û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
- `RRStrategy` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `apply_rr_logic()` –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- `RRDStrategy` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `apply_rr_logic()` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ RR –∏ RRD —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã
- ‚úÖ –õ–µ–≥—á–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (RRR, RRTS, Trailing RR)

#### üîß –ó–∞–¥–∞—á–∞ 2: –î–æ–±–∞–≤–ª–µ–Ω—ã ATR-—Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π:**
- ‚úÖ `volume > 0` - –æ–±—ä–µ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º
- ‚úÖ `high >= low` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å OHLC –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `high >= open/close` –∏ `low <= open/close` - –ª–æ–≥–∏–∫–∞ —Å–≤–µ—á–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–∞—á–∫–æ–≤ —Ü–µ–Ω—ã - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–¥–µ–ª–∫–∏ –ø—Ä–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö —Å–∫–∞—á–∫–∞—Ö (> X% –∑–∞ 1 –º–∏–Ω—É—Ç—É)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- `RRStrategy` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–∏ –≤—Ö–æ–¥–∞
- `RRDStrategy` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Å–≤–µ—á–µ–π –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –≤—Ö–æ–¥–∞ (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º)

**–ü–∞—Ä–∞–º–µ—Ç—Ä `max_price_jump_pct`** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.5%)

#### üîß –ó–∞–¥–∞—á–∞ 3: –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ StrategyOutput.meta

**–ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- ‚úÖ `minutes_in_market` - –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö
- ‚úÖ `max_favorable_excursion` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –¥–æ –≤—ã—Ö–æ–¥–∞ (–≤ –¥–æ–ª—è—Ö)
- ‚úÖ `max_adverse_excursion` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ –¥–æ –≤—ã—Ö–æ–¥–∞ (–≤ –¥–æ–ª—è—Ö)
- ‚úÖ `volatility_around_entry` - –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ–∫—Ä—É–≥ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
- ‚úÖ `signal_to_entry_delay_minutes` - –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–æ–º –∏ –≤—Ö–æ–¥–æ–º (–≤ –º–∏–Ω—É—Ç–∞—Ö)

**–û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è RRD-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**, –∫–æ—Ç–æ—Ä–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –∑–∞–¥–µ—Ä–∂–∫–µ –≤—Ö–æ–¥–∞.

#### üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- ‚úÖ –°–æ–∑–¥–∞–Ω—ã unit-—Ç–µ—Å—Ç—ã –¥–ª—è `rr_utils.py` (`tests/domain/test_rr_utils.py`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏
- ‚úÖ –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω –ª–∏–Ω—Ç–µ—Ä–æ–º - –æ—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

---

## [Phase 2] - 2025-01-XX

### –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –§–∞–∑–∞ 2: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –≤–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π OHLCV –≤ GeckoTerminalPriceLoader**
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π: `[timestamp, open, high, low, close, volume]`

2. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω end_time –≤ –≤—ã–∑–æ–≤ loader.load_prices() –≤ rr_strategy.py**
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–æ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

#### –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

3. ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–≤–µ—á–µ–π**
   - –§—É–Ω–∫—Ü–∏—è `validate_candle()` —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ OHLCV –¥–∞–Ω–Ω—ã—Ö

4. ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Reporter —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏**
   - –†–∞—Å—á–µ—Ç winrate, Sharpe ratio, max drawdown, profit factor –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç—Ä–∏–∫
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSV, HTML –æ—Ç—á–µ—Ç–æ–≤ –∏ equity curve –≥—Ä–∞—Ñ–∏–∫–æ–≤

5. ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ RRD-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å –≤—Ö–æ–¥–æ–º –ø–æ drawdown**
   - –ü–æ–ª–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞ –ø–æ drawdown —Å TP/SL
   - –ü–∞—Ä–∞–º–µ—Ç—Ä `entry_wait_minutes` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è –≤—Ö–æ–¥–∞

#### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

6. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã unit-—Ç–µ—Å—Ç—ã**
   - –¢–µ—Å—Ç—ã –¥–ª—è RR, RRD –∏ Runner —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

7. ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤**
   - ThreadPoolExecutor –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

8. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ retry-–ª–æ–≥–∏–∫–∞ –¥–ª—è API**
   - –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `retry_on_failure` —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

9. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
   - –ì—Ä–∞—Ñ–∏–∫–∏ equity curve, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è PnL, –ø—Ä–∏—á–∏–Ω—ã –≤—ã—Ö–æ–¥–∞, –≤—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ —Å–¥–µ–ª–æ–∫

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backtester/
‚îú‚îÄ‚îÄ application/
‚îÇ   ‚îî‚îÄ‚îÄ runner.py           # BacktestRunner —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # Signal, Candle, StrategyInput, StrategyOutput
‚îÇ   ‚îú‚îÄ‚îÄ strategy_base.py    # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å Strategy
‚îÇ   ‚îú‚îÄ‚îÄ rr_strategy.py      # RR —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç rr_utils)
‚îÇ   ‚îú‚îÄ‚îÄ rrd_strategy.py     # RRD —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç rr_utils)
‚îÇ   ‚îú‚îÄ‚îÄ rr_utils.py         # –û–±—â–∞—è RR-–ª–æ–≥–∏–∫–∞ –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ runner_strategy.py  # Runner —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îî‚îÄ‚îÄ infrastructure/
    ‚îú‚îÄ‚îÄ signal_loader.py    # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∏–∑ CSV
    ‚îú‚îÄ‚îÄ price_loader.py     # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π (CSV + GeckoTerminal API)
    ‚îî‚îÄ‚îÄ reporter.py         # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫

tests/
‚îî‚îÄ‚îÄ domain/
    ‚îú‚îÄ‚îÄ test_rr_strategy.py
    ‚îú‚îÄ‚îÄ test_rrd_strategy.py
    ‚îú‚îÄ‚îÄ test_runner_strategy.py
    ‚îî‚îÄ‚îÄ test_rr_utils.py
```


