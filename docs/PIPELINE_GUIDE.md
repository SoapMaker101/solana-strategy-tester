# ๐ ะะฐะนะฟะปะฐะนะฝ ะฟัะพะฒะตะดะตะฝะธั ััะตะฝะฐัะธะตะฒ: Solana Strategy Tester

**ะะฐัะฐ ัะพะทะดะฐะฝะธั:** 2025-12-14  
**ะะตััะธั:** 1.0

---

## ๐ ะะฑะทะพั

ะะพะบัะผะตะฝั ะพะฟะธััะฒะฐะตั ะฟะพะปะฝัะน workflow ัะฐะฑะพัั ั ัะธััะตะผะพะน Solana Strategy Tester: ะพั ะฟะพะดะณะพัะพะฒะบะธ ะดะฐะฝะฝัั ะดะพ ัะธะฝะฐะปัะฝะพะณะพ ะพัะฑะพัะฐ ัััะฐัะตะณะธะน. ะกะธััะตะผะฐ ะฟะพะดะดะตัะถะธะฒะฐะตั ะฝะตัะบะพะปัะบะพ ััะฐะฟะพะฒ ัะฐะฑะพัั, ะบะฐะถะดัะน ะธะท ะบะพัะพััั ัะตัะฐะตั ัะฒะพะธ ะทะฐะดะฐัะธ.

---

## ๐ฏ ะัะฝะพะฒะฝัะต ััะฐะฟั ัะฐะฑะพัั

ะกะธััะตะผะฐ ะฟะพะดะดะตัะถะธะฒะฐะตั ััะธ ะพัะฝะพะฒะฝัั ััะฐะฟะฐ:

1. **ะัะฝะพะฒะฝะพะน ะฑัะบัะตัั** (`main.py`) โ ัะตััะธัะพะฒะฐะฝะธะต ัััะฐัะตะณะธะน ะฝะฐ ะธััะพัะธัะตัะบะธั ะดะฐะฝะฝัั
2. **Stage A** (`run_stage_a.py`) โ ะฐะฝะฐะปะธะท ัััะพะนัะธะฒะพััะธ ัััะฐัะตะณะธะน
3. **Stage B** (`run_stage_b.py`) โ ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะพัะฑะพั ัััะฐัะตะณะธะน

---

## ๐ ะญัะฐะฟ 1: ะัะฝะพะฒะฝะพะน ะฑัะบัะตัั

### ะะฐะทะฝะฐัะตะฝะธะต

ะขะตััะธัะพะฒะฐะฝะธะต ัะพัะณะพะฒัั ัััะฐัะตะณะธะน ะฝะฐ ะธััะพัะธัะตัะบะธั ะดะฐะฝะฝัั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฒะฝะตัะฝะธั ัะธะณะฝะฐะปะพะฒ. ะะตะฝะตัะธััะตั ะดะตัะฐะปัะฝัะต ัะตะทัะปััะฐัั ะดะปั ะบะฐะถะดะพะน ัะดะตะปะบะธ ะธ ะฟะพัััะตะปัะฝัั ััะฐัะธััะธะบั.

### ะะพะผะฐะฝะดะฐ ะทะฐะฟััะบะฐ

```bash
python main.py \
  --signals signals/example_signals.csv \
  --strategies-config config/strategies_example.yaml \
  --backtest-config config/backtest_example.yaml \
  --json-output output/results.json \
  --max-workers 4
```

### ะะฐัะฐะผะตััั

- `--signals` โ ะฟััั ะบ CSV ัะฐะนะปั ั ัะธะณะฝะฐะปะฐะผะธ
- `--strategies-config` โ YAML ัะฐะนะป ั ะบะพะฝัะธะณััะฐัะธะตะน ัััะฐัะตะณะธะน
- `--backtest-config` โ YAML ัะฐะนะป ั ะณะปะพะฑะฐะปัะฝัะผะธ ะฝะฐัััะพะนะบะฐะผะธ ะฑัะบัะตััะฐ
- `--json-output` โ ะฟััั ะดะปั ัะพััะฐะฝะตะฝะธั JSON ะพััะตัะฐ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- `--max-workers` โ ะบะพะปะธัะตััะฒะพ ะฟะพัะพะบะพะฒ ะดะปั ะฟะฐัะฐะปะปะตะปัะฝะพะน ะพะฑัะฐะฑะพัะบะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### ะงัะพ ะฟัะพะธััะพะดะธั ะฒะฝัััะธ

1. **ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั:**
   - ะะฐะณััะถะฐัััั ัะธะณะฝะฐะปั ะธะท CSV ัะฐะนะปะฐ
   - ะะปั ะบะฐะถะดะพะณะพ ัะธะณะฝะฐะปะฐ ะพะฟัะตะดะตะปัะตััั ะฒัะตะผะตะฝะฝะพะต ะพะบะฝะพ (ะดะพ ะธ ะฟะพัะปะต ัะธะณะฝะฐะปะฐ)
   - ะะฐะณััะถะฐัััั ัะฒะตัะธ ะดะปั ะบะฐะถะดะพะณะพ ัะพะบะตะฝะฐ (ะธะท ะปะพะบะฐะปัะฝัั CSV ะธะปะธ ัะตัะตะท API)

2. **ะัะธะผะตะฝะตะฝะธะต ัััะฐัะตะณะธะน:**
   - ะะปั ะบะฐะถะดะพะณะพ ัะธะณะฝะฐะปะฐ ัะพะทะดะฐะตััั `StrategyInput` (ัะธะณะฝะฐะป + ัะฒะตัะธ + ะณะปะพะฑะฐะปัะฝัะต ะฟะฐัะฐะผะตััั)
   - ะะฐะถะดะฐั ัััะฐัะตะณะธั ะพะฑัะฐะฑะฐััะฒะฐะตั ัะธะณะฝะฐะป ะธ ะฒะพะทะฒัะฐัะฐะตั `StrategyOutput`
   - ะะตะทัะปััะฐัั ัะพะฑะธัะฐัััั ะฒ ะตะดะธะฝัะน ัะฟะธัะพะบ

3. **ะะตะฝะตัะฐัะธั ะพััะตัะพะฒ:**
   - ะกะพะทะดะฐัััั ะพััะตัั ะฝะฐ ััะพะฒะฝะต ัััะฐัะตะณะธะน (ะผะตััะธะบะธ, ะณัะฐัะธะบะธ, CSV)
   - ะกะพััะฐะฝัะตััั ะตะดะธะฝะฐั ัะฐะฑะปะธัะฐ ัะดะตะปะพะบ (`{strategy}_trades.csv`)
   - ะะฐะฟััะบะฐะตััั ะฟะพัััะตะปัะฝะฐั ัะธะผัะปััะธั
   - ะกะพััะฐะฝััััั ะฟะพัััะตะปัะฝัะต ัะตะทัะปััะฐัั

### ะััะพะดะฝัะต ะดะฐะฝะฝัะต

**ะคะฐะนะปั:**
- `output/reports/{strategy}_report.json` โ ะดะตัะฐะปัะฝัะน JSON ะพััะตั ะดะปั ะบะฐะถะดะพะน ัััะฐัะตะณะธะธ
- `output/reports/{strategy}_report.csv` โ CSV ะพััะตั ะดะปั ะบะฐะถะดะพะน ัััะฐัะตะณะธะธ
- `output/reports/{strategy}_report.html` โ HTML ะพััะตั ั ะณัะฐัะธะบะฐะผะธ
- `output/reports/{strategy}_trades.csv` โ ะตะดะธะฝะฐั ัะฐะฑะปะธัะฐ ะฒัะตั ัะดะตะปะพะบ ั ัะธัะฐะผะธ
- `output/reports/{strategy}_portfolio.json` โ ะฟะพัััะตะปัะฝัะต ัะตะทัะปััะฐัั

**ะะตััะธะบะธ:**
- Winrate, Sharpe ratio, max drawdown, profit factor
- ะะพัััะตะปัะฝัะต ะผะตััะธะบะธ (final balance, total return, max drawdown)
- ะะฐัะฟัะตะดะตะปะตะฝะธะต ะฟะพ ะธััะพัะฝะธะบะฐะผ ัะธะณะฝะฐะปะพะฒ ะธ ะฟัะธัะธะฝะฐะผ ะฒััะพะดะฐ

### ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ

**config/backtest_example.yaml:**
```yaml
data:
  loader: "gecko"  # ะธะปะธ "csv"
  candles_dir: "data/candles/cached"
  timeframe: "1m"
  before_minutes: 60
  after_minutes: 43200  # 30 ะดะฝะตะน

portfolio:
  initial_balance_sol: 10.0
  allocation_mode: "dynamic"
  percent_per_trade: 0.1
  max_exposure: 0.5
  max_open_positions: 10
  fee:
    swap_fee_pct: 0.003
    lp_fee_pct: 0.001
    slippage_pct: 0.10
    network_fee_sol: 0.0005
```

**config/strategies_example.yaml:**
```yaml
- name: "RR_2.0_0.5"
  type: "RR"
  params:
    tp_multiplier: 2.0
    sl_multiplier: 0.5
    timeout_minutes: 43200

- name: "RRD_3.0_1.5_0.5"
  type: "RRD"
  params:
    drawdown_pct: 0.15
    tp_multiplier: 3.0
    sl_multiplier: 0.5
    timeout_minutes: 43200
```

---

## ๐ ะญัะฐะฟ 2: Stage A โ ะะฝะฐะปะธะท ัััะพะนัะธะฒะพััะธ

### ะะฐะทะฝะฐัะตะฝะธะต

ะัะตะฝะบะฐ ัััะพะนัะธะฒะพััะธ ัััะฐัะตะณะธะน ะฟััะตะผ ัะฐะทะฑะธะตะฝะธั ะดะฐะฝะฝัั ะฝะฐ ะฒัะตะผะตะฝะฝัะต ะพะบะฝะฐ ะธ ะฐะฝะฐะปะธะทะฐ ััะฐะฑะธะปัะฝะพััะธ ัะตะทัะปััะฐัะพะฒ ะฒ ัะฐะทะฝัั ะฟะตัะธะพะดะฐั.

### ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั

ะะพัะปะต ะทะฐะฒะตััะตะฝะธั ะพัะฝะพะฒะฝะพะณะพ ะฑัะบัะตััะฐ, ะบะพะณะดะฐ ะฝัะถะฝะพ ะฟะพะฝััั:
- ะะฐัะบะพะปัะบะพ ััะฐะฑะธะปัะฝะฐ ัััะฐัะตะณะธั ะฝะฐ ัะฐะทะฝัั ะฒัะตะผะตะฝะฝัั ะฟะตัะธะพะดะฐั
- ะะฐะบะฐั ะดะพะปั ะฟะตัะธะพะดะพะฒ ะฟะพะบะฐะทัะฒะฐะตั ะฟัะธะฑัะปัะฝะพััั
- ะะฐัะบะพะปัะบะพ ะฒะตะปะธะบะฐ ะดะธัะฟะตััะธั ัะตะทัะปััะฐัะพะฒ

### ะะพะผะฐะฝะดะฐ ะทะฐะฟััะบะฐ

```bash
python -m backtester.research.run_stage_a \
  --reports-dir output/reports \
  --splits 2 3 4 5
```

### ะะฐัะฐะผะตััั

- `--reports-dir` โ ะดะธัะตะบัะพัะธั ั ัะฐะนะปะฐะผะธ `{strategy}_trades.csv` (ะฟะพ ัะผะพะปัะฐะฝะธั: `output/reports`)
- `--splits` โ ัะฟะธัะพะบ ะบะพะปะธัะตััะฒ ัะฐะทะฑะธะตะฝะธะน ะดะปั ะฐะฝะฐะปะธะทะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั: `[2, 3, 4, 5]`)

### ะงัะพ ะฟัะพะธััะพะดะธั ะฒะฝัััะธ

1. **ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั:**
   - ะะฐะณััะถะฐัััั ะฒัะต ัะฐะนะปั `{strategy}_trades.csv` ะธะท ัะบะฐะทะฐะฝะฝะพะน ะดะธัะตะบัะพัะธะธ
   - ะะปั ะบะฐะถะดะพะน ัััะฐัะตะณะธะธ ัะพะฑะธัะฐัััั ะฒัะต ัะดะตะปะบะธ

2. **ะะณัะตะณะฐัะธั ะฟะพ ะพะบะฝะฐะผ:**
   - ะะฐะฝะฝัะต ัะฐะทะฑะธะฒะฐัััั ะฝะฐ ัะฐะฒะฝัะต ะฒัะตะผะตะฝะฝัะต ะพะบะฝะฐ (2, 3, 4, 5 ัะฐััะตะน)
   - ะะปั ะบะฐะถะดะพะณะพ ะพะบะฝะฐ ะฒััะธัะปััััั ะผะตััะธะบะธ:
     - ะะพะปะธัะตััะฒะพ ัะดะตะปะพะบ
     - Winrate
     - Total PnL
     - Median PnL
     - Max drawdown
     - Profit factor
     - Worst trade, Best trade

3. **ะะฐััะตั ะผะตััะธะบ ัััะพะนัะธะฒะพััะธ:**
   - **Survival rate** โ ะดะพะปั ะพะบะพะฝ, ะฟะพะบะฐะทัะฒะฐััะธั ะฟัะธะฑัะปัะฝะพััั
   - **Worst window PnL** โ ััะดัะธะน ัะตะทัะปััะฐั ััะตะดะธ ะฒัะตั ะพะบะพะฝ
   - **Median window PnL** โ ะผะตะดะธะฐะฝะฝัะน ัะตะทัะปััะฐั ะพะบะพะฝ
   - **PnL variance** โ ะดะธัะฟะตััะธั ัะตะทัะปััะฐัะพะฒ ะพะบะพะฝ
   - **Windows total** โ ะพะฑัะตะต ะบะพะปะธัะตััะฒะพ ะพะบะพะฝ

### ะััะพะดะฝัะต ะดะฐะฝะฝัะต

**ะคะฐะนะปั:**
- `output/reports/strategy_stability.csv` โ ัะฐะฑะปะธัะฐ ัััะพะนัะธะฒะพััะธ ะฒัะตั ัััะฐัะตะณะธะน
- `output/reports/stage_a_summary.csv` โ ะดะตัะฐะปัะฝะฐั ัะฐะฑะปะธัะฐ ัะพ ะฒัะตะผะธ ะพะบะฝะฐะผะธ

**ะะพะปะพะฝะบะธ ะฒ strategy_stability.csv:**
- `strategy` โ ะธะผั ัััะฐัะตะณะธะธ
- `split_count` โ ะบะพะปะธัะตััะฒะพ ัะฐะทะฑะธะตะฝะธะน
- `survival_rate` โ ะดะพะปั ะฟัะธะฑัะปัะฝัั ะพะบะพะฝ (0.0 - 1.0)
- `worst_window_pnl` โ ััะดัะธะน PnL ััะตะดะธ ะพะบะพะฝ
- `median_window_pnl` โ ะผะตะดะธะฐะฝะฝัะน PnL ะพะบะพะฝ
- `pnl_variance` โ ะดะธัะฟะตััะธั PnL ะพะบะพะฝ
- `windows_total` โ ะพะฑัะตะต ะบะพะปะธัะตััะฒะพ ะพะบะพะฝ

### ะะฝัะตัะฟัะตัะฐัะธั ัะตะทัะปััะฐัะพะฒ

- **Survival rate > 0.7** โ ัััะฐัะตะณะธั ััะฐะฑะธะปัะฝะพ ะฟัะธะฑัะปัะฝะฐ ะฒ ะฑะพะปััะธะฝััะฒะต ะฟะตัะธะพะดะพะฒ
- **PnL variance < 0.01** โ ะฝะธะทะบะฐั ะดะธัะฟะตััะธั, ััะฐะฑะธะปัะฝัะต ัะตะทัะปััะฐัั
- **Worst window PnL > -0.1** โ ะดะฐะถะต ััะดัะธะน ะฟะตัะธะพะด ะฝะต ะฟัะธะฝะตั ะฑะพะปััะธั ะฟะพัะตัั

---

## โ ะญัะฐะฟ 3: Stage B โ ะัะฑะพั ัััะฐัะตะณะธะน

### ะะฐะทะฝะฐัะตะฝะธะต

ะะฒัะพะผะฐัะธัะตัะบะธะน ะพัะฑะพั ัััะฐัะตะณะธะน ะฝะฐ ะพัะฝะพะฒะต ะบัะธัะตัะธะตะฒ ัััะพะนัะธะฒะพััะธ, ััะฐะฑะธะปัะฝะพััะธ ะธ ะผะธะฝะธะผะฐะปัะฝัั ะฟะพัะตัั. ะคะธะปััััะตั ัััะฐัะตะณะธะธ ั ะฟะปะพัะธะผะธ ัะฐัะฐะบัะตัะธััะธะบะฐะผะธ.

### ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั

ะะพัะปะต ะทะฐะฒะตััะตะฝะธั Stage A, ะบะพะณะดะฐ ะฝัะถะฝะพ:
- ะะฒัะพะผะฐัะธัะตัะบะธ ะพััะธะปัััะพะฒะฐัั ะฝะตะบะฐัะตััะฒะตะฝะฝัะต ัััะฐัะตะณะธะธ
- ะะพะปััะธัั ัะฟะธัะพะบ ะฟัะพัะตะดัะธั ัััะฐัะตะณะธะน ะดะปั ะดะฐะปัะฝะตะนัะตะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- ะะพะฝััั ะฟัะธัะธะฝั ะพัะบะปะพะฝะตะฝะธั ัััะฐัะตะณะธะน

### ะะพะผะฐะฝะดะฐ ะทะฐะฟััะบะฐ

```bash
python -m backtester.decision.run_stage_b \
  --stability-csv output/reports/strategy_stability.csv \
  --output-csv output/reports/strategy_selection.csv
```

### ะะฐัะฐะผะตััั

- `--stability-csv` โ ะฟััั ะบ ัะฐะนะปั `strategy_stability.csv` ะธะท Stage A (ะฟะพ ัะผะพะปัะฐะฝะธั: `output/reports/strategy_stability.csv`)
- `--output-csv` โ ะฟััั ะดะปั ัะพััะฐะฝะตะฝะธั ัะตะทัะปััะฐัะพะฒ ะพัะฑะพัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั: ะฒ ัะพะน ะถะต ะดะธัะตะบัะพัะธะธ)

### ะงัะพ ะฟัะพะธััะพะดะธั ะฒะฝัััะธ

1. **ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั:**
   - ะะฐะณััะถะฐะตััั ัะฐะฑะปะธัะฐ ัััะพะนัะธะฒะพััะธ ะธะท Stage A

2. **ะัะธะผะตะฝะตะฝะธะต ะบัะธัะตัะธะตะฒ ะพัะฑะพัะฐ:**
   ะะปั ะบะฐะถะดะพะน ัััะฐัะตะณะธะธ ะฟัะพะฒะตัััััั ัะปะตะดัััะธะต ะบัะธัะตัะธะธ:
   - **survival_rate >= min_survival_rate** (ะฟะพ ัะผะพะปัะฐะฝะธั: 0.5)
   - **pnl_variance <= max_pnl_variance** (ะฟะพ ัะผะพะปัะฐะฝะธั: 0.1)
   - **worst_window_pnl >= min_worst_window_pnl** (ะฟะพ ัะผะพะปัะฐะฝะธั: -0.2)
   - **median_window_pnl >= min_median_window_pnl** (ะฟะพ ัะผะพะปัะฐะฝะธั: 0.0)
   - **windows_total >= min_windows** (ะฟะพ ัะผะพะปัะฐะฝะธั: 4)

3. **ะะฟัะตะดะตะปะตะฝะธะต ัะตะทัะปััะฐัะฐ:**
   - ะกััะฐัะตะณะธั ะฟัะพัะพะดะธั, ะตัะปะธ **ะะกะ** ะบัะธัะตัะธะธ ะฒัะฟะพะปะฝะตะฝั
   - ะะปั ะฝะตะฟัะพัะตะดัะธั ัััะฐัะตะณะธะน ัะธะบัะธัััััั ะฟัะธัะธะฝั ะพัะบะปะพะฝะตะฝะธั

### ะััะพะดะฝัะต ะดะฐะฝะฝัะต

**ะคะฐะนะปั:**
- `output/reports/strategy_selection.csv` โ ัะฐะฑะปะธัะฐ ะพัะฑะพัะฐ ัะพ ะฒัะตะผะธ ัััะฐัะตะณะธัะผะธ

**ะะพะปะพะฝะบะธ ะฒ strategy_selection.csv:**
- ะัะต ะบะพะปะพะฝะบะธ ะธะท `strategy_stability.csv`
- `passed` โ ะฑัะปะตะฒะพ ะทะฝะฐัะตะฝะธะต (ะฟัะพัะปะฐ ะปะธ ัััะฐัะตะณะธั ะพัะฑะพั)
- `failed_reasons` โ ัะฟะธัะพะบ ะฟัะธัะธะฝ ะพัะบะปะพะฝะตะฝะธั (ะตัะปะธ ะฝะต ะฟัะพัะปะฐ)

### ะัะธัะตัะธะธ ะฟะพ ัะผะพะปัะฐะฝะธั

```python
SelectionCriteria(
    min_survival_rate=0.5,           # 50% ะพะบะพะฝ ะดะพะปะถะฝั ะฑััั ะฟัะธะฑัะปัะฝัะผะธ
    max_pnl_variance=0.1,            # ะะธัะฟะตััะธั ะฝะต ะดะพะปะถะฝะฐ ะฑััั ัะปะธัะบะพะผ ะฒััะพะบะพะน
    min_worst_window_pnl=-0.2,       # ะะฐะถะต ััะดัะธะน ะฟะตัะธะพะด ะฝะต ะดะพะปะถะตะฝ ะฟัะธะฝะตััะธ >20% ะฟะพัะตัั
    min_median_window_pnl=0.0,       # ะะตะดะธะฐะฝะฝัะน ัะตะทัะปััะฐั ะดะพะปะถะตะฝ ะฑััั ะฝะตะพััะธัะฐัะตะปัะฝัะผ
    min_windows=4                    # ะะธะฝะธะผัะผ 4 ะพะบะฝะฐ ะดะปั ััะฐัะธััะธัะตัะบะพะน ะทะฝะฐัะธะผะพััะธ
)
```

**ะะฐัััะพะนะบะฐ ะบัะธัะตัะธะตะฒ:**

ะัะธัะตัะธะธ ะผะพะถะฝะพ ะธะทะผะตะฝะธัั, ะพััะตะดะฐะบัะธัะพะฒะฐะฒ `backtester/decision/selection_rules.py`:

```python
DEFAULT_CRITERIA = SelectionCriteria(
    min_survival_rate=0.6,           # ะะพะปะตะต ัััะพะณะธะน ะบัะธัะตัะธะน
    max_pnl_variance=0.05,           # ะะตะฝััะฐั ะดะธัะฟะตััะธั
    min_worst_window_pnl=-0.15,      # ะะตะฝััะธะต ะฟะพัะตัะธ
    min_median_window_pnl=0.05,      # ะะพะปะพะถะธัะตะปัะฝะฐั ะผะตะดะธะฐะฝะฐ
    min_windows=4
)
```

### ะะฝัะตัะฟัะตัะฐัะธั ัะตะทัะปััะฐัะพะฒ

- **passed=True** โ ัััะฐัะตะณะธั ะฟัะพัะปะฐ ะฒัะต ะบัะธัะตัะธะธ ะธ ัะตะบะพะผะตะฝะดัะตััั ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- **passed=False** โ ัััะฐัะตะณะธั ะพัะบะปะพะฝะตะฝะฐ, ะฟัะธัะธะฝั ัะบะฐะทะฐะฝั ะฒ `failed_reasons`

---

## ๐ ะะพะปะฝัะน workflow

### ะขะธะฟะธัะฝัะน ััะตะฝะฐัะธะน ะธัะฟะพะปัะทะพะฒะฐะฝะธั

```bash
# ะจะฐะณ 1: ะัะฝะพะฒะฝะพะน ะฑัะบัะตัั
python main.py \
  --signals signals/my_signals.csv \
  --strategies-config config/my_strategies.yaml \
  --backtest-config config/backtest_example.yaml

# ะจะฐะณ 2: ะะฝะฐะปะธะท ัััะพะนัะธะฒะพััะธ (Stage A)
python -m backtester.research.run_stage_a \
  --reports-dir output/reports \
  --splits 2 3 4 5

# ะจะฐะณ 3: ะัะฑะพั ัััะฐัะตะณะธะน (Stage B)
python -m backtester.decision.run_stage_b \
  --stability-csv output/reports/strategy_stability.csv

# ะะตะทัะปััะฐั: output/reports/strategy_selection.csv
# ัะพะดะตัะถะธั ัะฟะธัะพะบ ะฟัะพัะตะดัะธั ัััะฐัะตะณะธะน
```

### ะะฟัะธะผะธะทะฐัะธั ะฟะฐัะฐะผะตััะพะฒ ัััะฐัะตะณะธะน

```bash
# ะจะฐะณ 1: ะะตะฝะตัะฐัะธั grid ะฟะฐัะฐะผะตััะพะฒ
python scripts/generate_rr_rrd_grid.py \
  --output config/strategies_grid.yaml

# ะจะฐะณ 2: ะัะบัะตัั ะฒัะตั ะบะพะผะฑะธะฝะฐัะธะน
python main.py \
  --strategies-config config/strategies_grid.yaml \
  --backtest-config config/backtest_example.yaml

# ะจะฐะณ 3: ะะฝะฐะปะธะท ัััะพะนัะธะฒะพััะธ
python -m backtester.research.run_stage_a

# ะจะฐะณ 4: ะัะฑะพั ะปัััะธั
python -m backtester.decision.run_stage_b

# ะะตะทัะปััะฐั: ัะฟะธัะพะบ ะพะฟัะธะผะฐะปัะฝัั ัััะฐัะตะณะธะน
```

---

## ๐ ะะทะฐะธะผะพัะฒัะทั ััะฐะฟะพะฒ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะญัะฐะฟ 1: ะัะฝะพะฒะฝะพะน ะฑัะบัะตัั                  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ                  โ
โ  โ ะกะธะณะฝะฐะปั  โโ โ ะกััะฐัะตะณะธะธโโ โ ะะตะทัะปััะฐััโ                  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ                  โ
โ                                  โ                           โ
โ                         {strategy}_trades.csv               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ะญัะฐะฟ 2: Stage A (ะฃััะพะนัะธะฒะพััั)                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ ะะณัะตะณะฐัะธั ะฟะพ ะพะบะฝะฐะผ   โ                                   โ
โ  โ - 2, 3, 4, 5 ัะฐััะตะน  โ                                   โ
โ  โ - ะะตััะธะบะธ ะฟะพ ะพะบะฝะฐะผ   โ                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ                    โ                                         โ
โ         strategy_stability.csv                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ             ะญัะฐะฟ 3: Stage B (ะัะฑะพั ัััะฐัะตะณะธะน)               โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ ะัะธะผะตะฝะตะฝะธะต ะบัะธัะตัะธะตะฒ โ                                   โ
โ  โ - Survival rate      โ                                   โ
โ  โ - Variance           โ                                   โ
โ  โ - Worst window       โ                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ                    โ                                         โ
โ         strategy_selection.csv                              โ
โ              (passed=True/False)                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ก ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะปั ะฝะฐัะธะฝะฐััะธั

1. ะะฐัะฝะธัะต ั ะพัะฝะพะฒะฝะพะณะพ ะฑัะบัะตััะฐ ะฝะฐ ะฝะตะฑะพะปััะพะผ ะฝะฐะฑะพัะต ัััะฐัะตะณะธะน
2. ะะทััะธัะต ัะตะทัะปััะฐัั ะธ ะฟะพัััะตะปัะฝัะต ะผะตััะธะบะธ
3. ะะฐะฟัััะธัะต Stage A ะดะปั ะฟะพะฝะธะผะฐะฝะธั ัััะพะนัะธะฒะพััะธ
4. ะัะฟะพะปัะทัะนัะต Stage B ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะพัะฑะพัะฐ

### ะะปั ะพะฟััะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

1. ะัะฟะพะปัะทัะนัะต grid ะณะตะฝะตัะฐัะพั ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ ะฟะฐัะฐะผะตััะพะฒ
2. ะะฐะฟััะบะฐะนัะต ะฟะพะปะฝัะน pipeline ะดะปั ะผะฐััะพะฒะพะณะพ ัะตััะธัะพะฒะฐะฝะธั
3. ะะฐัััะฐะธะฒะฐะนัะต ะบัะธัะตัะธะธ ะพัะฑะพัะฐ ะฟะพะด ัะฒะพะธ ััะตะฑะพะฒะฐะฝะธั
4. ะะฝะฐะปะธะทะธััะนัะต trade features ะดะปั ะณะปัะฑะพะบะพะณะพ ะฟะพะฝะธะผะฐะฝะธั

### ะะปั ะธััะปะตะดะพะฒะฐัะตะปะตะน

1. ะญะบัะฟะตัะธะผะตะฝัะธััะนัะต ั ัะฐะทะฝัะผะธ ัะฐะทะฑะธะตะฝะธัะผะธ ะฒ Stage A
2. ะะฝะฐะปะธะทะธััะนัะต stage_a_summary.csv ะดะปั ะดะตัะฐะปัะฝะพะณะพ ะฟะพะฝะธะผะฐะฝะธั ะพะบะพะฝ
3. ะกะพะทะดะฐะฒะฐะนัะต ัะพะฑััะฒะตะฝะฝัะต ะบัะธัะตัะธะธ ะพัะฑะพัะฐ
4. ะัะฟะพะปัะทัะนัะต trade features ะดะปั ะผะฐัะธะฝะฝะพะณะพ ะพะฑััะตะฝะธั

---

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะัะพะฑะปะตะผะฐ: ะะตั ัะฐะนะปะพะฒ trades.csv ะฟะพัะปะต ะฑัะบัะตััะฐ

**ะัะธัะธะฝะฐ:** ะัะบัะตัั ะฝะต ะทะฐะฒะตััะธะปัั ััะฟะตัะฝะพ ะธะปะธ ะฝะต ะฑัะปะธ ัะณะตะฝะตัะธัะพะฒะฐะฝั ะพััะตัั  
**ะะตัะตะฝะธะต:** 
1. ะัะพะฒะตัััะต, ััะพ ะฑัะบัะตัั ะทะฐะฒะตััะธะปัั ะฑะตะท ะพัะธะฑะพะบ
2. ะฃะฑะตะดะธัะตัั, ััะพ ัะบะฐะทะฐะฝะฐ ะฟัะฐะฒะธะปัะฝะฐั ะดะธัะตะบัะพัะธั ะดะปั ะพััะตัะพะฒ
3. ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ัะฐะนะปะพะฒ ะฒ `output/reports/`

### ะัะพะฑะปะตะผะฐ: Stage A ะฝะต ะฝะฐัะพะดะธั ัะฐะนะปั

**ะัะธัะธะฝะฐ:** ะะตะฟัะฐะฒะธะปัะฝะฐั ะดะธัะตะบัะพัะธั ะธะปะธ ะฝะตะฟัะฐะฒะธะปัะฝัะต ะธะผะตะฝะฐ ัะฐะนะปะพะฒ  
**ะะตัะตะฝะธะต:**
1. ะฃะฑะตะดะธัะตัั, ััะพ ัะฐะนะปั ะฝะฐะทะฒะฐะฝั ะบะฐะบ `{strategy}_trades.csv`
2. ะัะพะฒะตัััะต ะฟััั ะฒ ะฟะฐัะฐะผะตััะต `--reports-dir`
3. ะฃะฑะตะดะธัะตัั, ััะพ ัะฐะนะปั ัะพะดะตัะถะฐั ะพะฑัะทะฐัะตะปัะฝัะต ะบะพะปะพะฝะบะธ

### ะัะพะฑะปะตะผะฐ: ะัะต ัััะฐัะตะณะธะธ ะพัะบะปะพะฝะตะฝั ะฒ Stage B

**ะัะธัะธะฝะฐ:** ะัะธัะตัะธะธ ะพัะฑะพัะฐ ัะปะธัะบะพะผ ัััะพะณะธะต  
**ะะตัะตะฝะธะต:**
1. ะกะผัะณัะธัะต ะบัะธัะตัะธะธ ะฒ `selection_rules.py`
2. ะัะพะฒะตัััะต ัะตะทัะปััะฐัั Stage A โ ะฒะพะทะผะพะถะฝะพ, ัััะฐัะตะณะธะธ ะดะตะนััะฒะธัะตะปัะฝะพ ะฟะปะพัะธะต
3. ะะฐััะผะพััะธัะต ะฒะพะทะผะพะถะฝะพััั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฑะพะปะตะต ะผัะณะบะธั ะบัะธัะตัะธะตะฒ

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั

- **PRODUCT_ANALYSIS.md** โ ะฟัะพะดัะบัะพะฒัะน ะฐะฝะฐะปะธะท ะธ ััะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
- **TECHNICAL_REPORT.md** โ ัะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั
- **ARCHITECTURE.md** โ ะฐััะธัะตะบัััะฝัะน ะฐะฝะฐะปะธะท ะธ ััััะบัััะฐ ะผะพะดัะปะตะน
- **PORTFOLIO_LAYER.md** โ ะดะพะบัะผะตะฝัะฐัะธั ะฟะพัััะตะปัะฝะพะณะพ ัะปะพั
- **CHANGELOG.md** โ ะธััะพัะธั ะธะทะผะตะฝะตะฝะธะน

---

*ะะพะบัะผะตะฝั ะพะฑะฝะพะฒะปะตะฝ: 2025-12-14*



