# üîÑ –ü–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞ —Å–≤–µ—á–µ–π

## ‚ùì –ü–æ—á–µ–º—É –∫–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ?

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `main.py` –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –∫–µ—à–µ (`data/candles/cached/1m/`) –¥–∞–∂–µ –µ—Å–ª–∏ —Å–≤–µ—á–∏ —É–∂–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ä–∞–Ω–µ–µ. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:

---

## üîç –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–µ—à –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ‚úÖ

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–µ—à–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ª–∏ –∫–µ—à –Ω—É–∂–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω
- –ï—Å–ª–∏ –¥–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –∫–µ—à, **–±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API**
- –§–∞–π–ª –∫–µ—à–∞ **–ù–ï –∏–∑–º–µ–Ω—è–µ—Ç—Å—è**

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–µ—à: 2024-12-01 00:00 ‚Üí 2024-12-10 23:59
–ó–∞–ø—Ä–æ—Å: 2024-12-05 10:00 ‚Üí 2024-12-08 15:00
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–µ—à, —Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
```

**–õ–æ–≥–∏:**
```
[CACHE ‚úÖ] Using cached candles for {contract} ({len} candles, range: ... to ...)
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–µ—à –ù–ï –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ‚ö†Ô∏è

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç, —á—Ç–æ –∫–µ—à –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç **–í–°–ï —Å–≤–µ—á–∏** —á–µ—Ä–µ–∑ API (–Ω–µ —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ!)
- **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** —Ñ–∞–π–ª –∫–µ—à–∞ –≤—Å–µ–º–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —Å–≤–µ—á–∞–º–∏

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–µ—à: 2024-12-01 00:00 ‚Üí 2024-12-10 23:59
–ó–∞–ø—Ä–æ—Å: 2024-12-05 10:00 ‚Üí 2024-12-15 15:00  (–Ω—É–∂–Ω—ã —Å–≤–µ—á–∏ –ø–æ—Å–ª–µ 10 –¥–µ–∫–∞–±—Ä—è)
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ö†Ô∏è –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API, —Ñ–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
```

**–õ–æ–≥–∏:**
```
[CACHE ‚ö†Ô∏è] Incomplete coverage for {contract} (missing: end (cache: ..., needed: ...)), reloading from API
üì¶ Total candles fetched: {len}
üìÖ Saved {len} candles to cache: {path}
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–µ—à–∞ –Ω–µ—Ç ‚ùå

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ö–µ—à –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ñ–∞–π–ª –∫–µ—à–∞

**–õ–æ–≥–∏:**
```
[CACHE ‚ùå] No cache found, loading from API for {contract}
üì¶ Total candles fetched: {len}
üìÖ Saved {len} candles to cache: {path}
```

---

## üîß –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ú–µ—Ç–æ–¥ `_save_to_cache()` (—Å—Ç—Ä–æ–∫–∏ 253-270)

```python
def _save_to_cache(self, path: Path, candles: List[Candle]):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–µ—á–∏ –≤ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CSV-—Ñ–∞–π–ª.
    """
    df = pd.DataFrame([{...} for c in candles])
    df.to_csv(path, index=False)  # ‚ö†Ô∏è –ü–û–õ–ù–ê–Ø –ü–ï–†–ï–ó–ê–ü–ò–°–¨ —Ñ–∞–π–ª–∞
```

**–í–∞–∂–Ω–æ:** –ú–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `df.to_csv(path, index=False)`, –∫–æ—Ç–æ—Ä—ã–π **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** —Ñ–∞–π–ª, –∞ –Ω–µ –¥–æ–ø–æ–ª–Ω—è–µ—Ç –µ–≥–æ.

### –ú–µ—Ç–æ–¥ `load_prices()` (—Å—Ç—Ä–æ–∫–∏ 395-598)

**–õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è** (—Å—Ç—Ä–æ–∫–∏ 418-435):
   ```python
   if covers_start and covers_end:
       # –ö–µ—à –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –µ–≥–æ
       return filtered  # –§–∞–π–ª –ù–ï –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
   ```

2. **–ï—Å–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω –Ω–µ –ø–æ–∫—Ä—ã—Ç** (—Å—Ç—Ä–æ–∫–∏ 437-560):
   ```python
   # –î–∏–∞–ø–∞–∑–æ–Ω –Ω–µ –ø–æ–∫—Ä—ã—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é
   print(f"[CACHE ‚ö†Ô∏è] Incomplete coverage, reloading from API")
   
   # –ó–∞–≥—Ä—É–∂–∞–µ–º –í–°–ï —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API
   candles = []  # –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏ –∑–∞–Ω–æ–≤–æ
   # ... –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ API ...
   
   # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–µ—à (–ü–û–õ–ù–ê–Ø –ü–ï–†–ï–ó–ê–ü–ò–°–¨)
   self._save_to_cache(cache_path, candles)
   ```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç **–≤—Å–µ —Å–≤–µ—á–∏** —á–µ—Ä–µ–∑ API, –¥–∞–∂–µ —Ç–µ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ –∫–µ—à–µ, –∞ –∑–∞—Ç–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª.

---

## ‚ö†Ô∏è –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

### –ü—Ä–∏—á–∏–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–µ—à–∞:

1. **–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω, –≤—ã—Ö–æ–¥—è—â–∏–π –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–µ—à–∞:**
   - –ö–µ—à: 2024-12-01 ‚Üí 2024-12-10
   - –ó–∞–ø—Ä–æ—Å: 2024-12-05 ‚Üí 2024-12-15 (–Ω—É–∂–Ω—ã —Å–≤–µ—á–∏ –ø–æ—Å–ª–µ 10 –¥–µ–∫–∞–±—Ä—è)
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏, —Ñ–∞–π–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è

2. **–ö–µ—à —É—Å—Ç–∞—Ä–µ–ª:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ `_is_cache_fresh()` (—Å—Ç—Ä–æ–∫–∏ 216-230) –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–µ!
   - –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –Ω–æ –Ω–µ —Å–≤–µ–∂–µ—Å—Ç—å –∫–µ—à–∞

3. **–°–∏–≥–Ω–∞–ª—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏:**
   - –ï—Å–ª–∏ –≤ `main.py` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–∏–≥–Ω–∞–ª—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
   - –ö–∞–∂–¥—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–∂–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω —Å–≤–µ—á–µ–π
   - –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–∏–≥–Ω–∞–ª —Ç—Ä–µ–±—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤–Ω–µ –∫–µ—à–∞ ‚Üí –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

---

## üìä –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏?

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞

**–ù–ï –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
- ‚ùå –°—Ç–∞—Ä—ã–µ —Å–≤–µ—á–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚ùå –ù–æ–≤—ã–µ —Å–≤–µ—á–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Å—Ç–∞—Ä—ã–º
- ‚úÖ –§–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤—Å–µ–º–∏ —Å–≤–µ—á–∞–º–∏, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ API

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API (–≤–∫–ª—é—á–∞—è —Ç–µ, —á—Ç–æ —É–∂–µ –±—ã–ª–∏ –≤ –∫–µ—à–µ)
2. –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π DataFrame —Å–æ –≤—Å–µ–º–∏ —Å–≤–µ—á–∞–º–∏
3. –§–∞–π–ª –∫–µ—à–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è (`df.to_csv()`)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–≤–µ—á–∏, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–µ—à–µ —Ç–µ—Ä—è—é—Ç—Å—è (–µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–∞–Ω–æ–≤–æ)

---

## üéØ –ö–æ–≥–¥–∞ –∫–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è?

### –ö–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏:

1. ‚úÖ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω, –≤—ã—Ö–æ–¥—è—â–∏–π –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–µ—à–∞
2. ‚úÖ –ö–µ—à –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
3. ‚úÖ –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∫–µ—à–∞

### –ö–µ—à –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏:

1. ‚úÖ –ö–µ—à –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
2. ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω –∫–µ—à–∞

---

## üí° –ü–æ—á–µ–º—É —Ç–∞–∫ —Å–¥–µ–ª–∞–Ω–æ?

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è):

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ - –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò–∑–±–µ–≥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ - –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏, –¥–∞–∂–µ —Ç–µ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å
- ‚ö†Ô∏è –ú–Ω–æ–≥–æ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
- ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### TODO –≤ –∫–æ–¥–µ (—Å—Ç—Ä–æ–∫–∞ 449):

```python
# TODO: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å - –¥–æ–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —á–∞—Å—Ç–∏
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–Ω–∞—é—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ –∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é.

---

## üîß –ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å?

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–õ–æ–≥–∏–∫–∞:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–µ—à
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Å–≤–µ—á–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç (–¥–æ –Ω–∞—á–∞–ª–∞ –∏–ª–∏ –ø–æ—Å–ª–µ –∫–æ–Ω—Ü–∞)
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API
4. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ —Å–≤–µ—á–∏
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—ä–µ–¥–∏–Ω—è—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ –∫–µ—à–∞

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –Ω–æ –∏ —Å–≤–µ–∂–µ—Å—Ç—å –∫–µ—à–∞
2. –ï—Å–ª–∏ –∫–µ—à —Å–≤–µ–∂–∏–π –∏ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ
3. –ï—Å–ª–∏ –∫–µ—à —É—Å—Ç–∞—Ä–µ–ª - –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —á–∞—Å—Ç–∏

**–ú–µ—Ç–æ–¥ `_is_cache_fresh()` —É–∂–µ –µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!**

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞:**
   - –ï—Å–ª–∏ –≤—Å–µ —Å–∏–≥–Ω–∞–ª—ã –≤ –æ–¥–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
   - –ö–µ—à –±—É–¥–µ—Ç –ø–æ–∫—Ä—ã–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è

2. **–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ —Å–≤–µ—á–∏ –∑–∞—Ä–∞–Ω–µ–µ:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –Ω—É–∂–Ω—ã—Ö —Å–≤–µ—á–µ–π
   - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–µ—à

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `before_minutes` –∏ `after_minutes`:**
   - –í `config/backtest_example.yaml`
   - –£–º–µ–Ω—å—à–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω—ã –≤—Å–µ –¥–∞–Ω–Ω—ã–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
   - –î–æ–∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —á–∞—Å—Ç–∏
   - –û–±—ä–µ–¥–∏–Ω—è—Ç—å —Å—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ —Å–≤–µ—á–∏

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–≤–µ–∂–µ—Å—Ç–∏ –∫–µ—à–∞:**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `_is_cache_fresh()` –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
   - –û–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —á–∞—Å—Ç–∏

3. **–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é "force refresh":**
   - –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–µ—à
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à, –µ—Å–ª–∏ –æ–Ω –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

### –í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

–í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å –ª–æ–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
- `[CACHE ‚úÖ]` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–µ—à
- `[CACHE ‚ö†Ô∏è]` - –∫–µ—à –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω, –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ API
- `[CACHE ‚ùå]` - –∫–µ—à–∞ –Ω–µ—Ç, –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ API
- `üìÖ Saved {len} candles to cache` - —Ñ–∞–π–ª –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã:

1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –≤ `main.py`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∫–µ—à
3. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–µ—à–∞ ‚Üí –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

---

## üìä –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ö–µ—à –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

```
–ö–µ—à: 2024-12-01 00:00 ‚Üí 2024-12-10 23:59
–°–∏–≥–Ω–∞–ª 1: 2024-12-05 10:00 (–∑–∞–ø—Ä–æ—Å: 2024-12-05 09:00 ‚Üí 2024-12-05 16:00)
–°–∏–≥–Ω–∞–ª 2: 2024-12-08 15:00 (–∑–∞–ø—Ä–æ—Å: 2024-12-08 14:00 ‚Üí 2024-12-08 21:00)

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –û–±–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–µ—à, —Ñ–∞–π–ª –ù–ï –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
```

### –ü—Ä–∏–º–µ—Ä 2: –ö–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

```
–ö–µ—à: 2024-12-01 00:00 ‚Üí 2024-12-10 23:59
–°–∏–≥–Ω–∞–ª 1: 2024-12-05 10:00 (–∑–∞–ø—Ä–æ—Å: 2024-12-05 09:00 ‚Üí 2024-12-05 16:00) ‚úÖ
–°–∏–≥–Ω–∞–ª 2: 2024-12-12 15:00 (–∑–∞–ø—Ä–æ—Å: 2024-12-12 14:00 ‚Üí 2024-12-12 21:00) ‚ùå

–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ö†Ô∏è –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–µ—à–∞
‚Üí –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API
‚Üí –§–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
```

---

## ‚úÖ –í—ã–≤–æ–¥—ã

1. **–ö–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω –≤–Ω–µ –∫–µ—à–∞**
2. **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è** (–Ω–µ –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è)
3. **–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Å–≤–µ—á–∏ —á–µ—Ä–µ–∑ API**, –¥–∞–∂–µ —Ç–µ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ –∫–µ—à–µ
4. **–≠—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
5. **–í –∫–æ–¥–µ –µ—Å—Ç—å TODO** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: 2025-12-13*




















