# –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-01-XX  
**–Ø–∑—ã–∫:** –†—É—Å—Å–∫–∏–π

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∞—è –∫–∞—Ä—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö](#1-–æ–±—â–∞—è-–∫–∞—Ä—Ç–∞-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
2. [–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è (Portfolio)](#2-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã-–ø–æ—Ä—Ç—Ñ–µ–ª—è-portfolio)
3. [Execution / Fees / Slippage](#3-execution--fees--slippage)
4. [–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ (Strategy Parameters)](#4-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏-strategy-parameters)
5. [–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Data Configuration)](#5-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã-–¥–∞–Ω–Ω—ã—Ö-data-configuration)
6. [Stage A / B / C ‚Äî Research –ø–∞—Ä–∞–º–µ—Ç—Ä—ã](#6-stage-a--b--c--research-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
7. [CLI –∞—Ä–≥—É–º–µ–Ω—Ç—ã](#7-cli-–∞—Ä–≥—É–º–µ–Ω—Ç—ã)
8. [CSV / Data schema](#8-csv--data-schema)
9. [Flags / Modes / Switches](#9-flags--modes--switches)
10. [–°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#10-—Å–≤—è–∑–∏-–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
11. [–°—Ç–∞—Ç—É—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤](#11-—Å—Ç–∞—Ç—É—Å-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

---

## 1. –û–±—â–∞—è –∫–∞—Ä—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –ì—Ä—É–ø–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

1. **–ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (`portfolio` –≤ YAML)
   - –ë–∞–ª–∞–Ω—Å, –∞–ª–ª–æ–∫–∞—Ü–∏—è, –ª–∏–º–∏—Ç—ã –ø–æ–∑–∏—Ü–∏–π
   - –ö–æ–º–∏—Å—Å–∏–∏ –∏ slippage
   - Runner reset –ª–æ–≥–∏–∫–∞

2. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π** (`strategies` YAML)
   - RR Strategy: TP, SL, timeout
   - RRD Strategy: drawdown, TP, SL, wait time
   - Runner Strategy: stub —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

3. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö** (`data` –≤ YAML)
   - –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (CSV/Gecko API)
   - –¢–∞–π–º—Ñ—Ä–µ–π–º —Å–≤–µ—á–µ–π
   - –û–∫–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–∫—Ä—É–≥ —Å–∏–≥–Ω–∞–ª–æ–≤
   - Rate limiting –¥–ª—è API

4. **Research –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (Stage A/B)
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∫–æ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

5. **CLI –∞—Ä–≥—É–º–µ–Ω—Ç—ã** (`main.py`)
   - –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
   - –†–µ–∂–∏–º—ã –æ—Ç—á–µ—Ç–æ–≤
   - Execution profiles

### –ì–¥–µ –∂–∏–≤—É—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- **YAML –∫–æ–Ω—Ñ–∏–≥–∏:**
  - `config/backtest_example.yaml` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—ç–∫—Ç–µ—Å—Ç–∞
  - `config/strategies_example.yaml` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

- **–ö–æ–¥ (–¥–µ—Ñ–æ–ª—Ç—ã):**
  - `backtester/domain/portfolio.py` ‚Äî PortfolioConfig, FeeModel
  - `backtester/domain/execution_model.py` ‚Äî ExecutionModel
  - `backtester/domain/rr_strategy.py`, `rrd_strategy.py` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
  - `backtester/research/window_aggregator.py` ‚Äî DEFAULT_SPLITS
  - `backtester/decision/selection_rules.py` ‚Äî DEFAULT_CRITERIA

- **CLI:**
  - `main.py` ‚Äî argparse –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

## 2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è (Portfolio)

### `initial_balance_sol`

- **–ì–¥–µ:** `portfolio.initial_balance_sol` (YAML), `PortfolioConfig.initial_balance_sol` (–∫–æ–¥)
- **–¢–∏–ø:** `float`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `10.0`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–æ—Ä—Ç—Ñ–µ–ª—è –≤ SOL
- **–í–ª–∏—è–Ω–∏–µ:** –ë–∞–∑–∞ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ PnL, allocation, equity curve
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()`, —Ä–∞—Å—á—ë—Ç `total_return_pct`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `allocation_mode`

- **–ì–¥–µ:** `portfolio.allocation_mode` (YAML), `PortfolioConfig.allocation_mode` (–∫–æ–¥)
- **–¢–∏–ø:** `Literal["fixed", "dynamic"]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"dynamic"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∂–∏–º —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
  - `"fixed"` ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (`initial_balance_sol`)
  - `"dynamic"` ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (—É—á–∏—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫)
- **–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–æ—Å—Ç/–ø–∞–¥–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
  - `fixed`: —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    - **–í–∞–∂–Ω–æ:** –í fixed mode `total_capital` = `initial_balance_sol` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ `max_exposure`
    - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö –ø–æ–∑–∏—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ `percent_per_trade=0.002`)
  - `dynamic`: —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å—Ç–µ—Ç/–ø–∞–¥–∞–µ—Ç –≤–º–µ—Å—Ç–µ —Å –±–∞–ª–∞–Ω—Å–æ–º (compound effect)
    - –í dynamic mode `total_capital` = `available_balance + total_open_notional`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._position_size()`, —Ä–∞—Å—á–µ—Ç `total_capital` –¥–ª—è `max_exposure`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `percent_per_trade`

- **–ì–¥–µ:** `portfolio.percent_per_trade` (YAML), `PortfolioConfig.percent_per_trade` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.02 = 2%, 0.002 = 0.2%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.1` (10%) –≤ –∫–æ–¥–µ, `0.02` (2%) –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–ª—è –∫–∞–ø–∏—Ç–∞–ª–∞ –Ω–∞ –æ–¥–Ω—É —Å–¥–µ–ª–∫—É
- **–í–ª–∏—è–Ω–∏–µ:** –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ = `base * percent_per_trade`, –≥–¥–µ `base` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `allocation_mode`
  - Fixed mode: `position_size = initial_balance_sol * percent_per_trade`
  - Dynamic mode: `position_size = current_balance * percent_per_trade`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._position_size()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –í–∞–∂–Ω–æ:** 
  - –í YAML —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –¥–æ–ª—è (0.02 = 2%, 0.002 = 0.2%), –Ω–µ –ø—Ä–æ—Ü–µ–Ω—Ç (2)
  - –ù–ï –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 100 –≤ –∫–æ–¥–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ –¥–æ–ª—è

### `max_exposure`

- **–ì–¥–µ:** `portfolio.max_exposure` (YAML), `PortfolioConfig.max_exposure` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.8 = 80%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.5` (50%) –≤ –∫–æ–¥–µ, `0.8` (80%) –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è (–¥–æ–ª—è –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ —Ä—ã–Ω–∫–µ)
- **–í–ª–∏—è–Ω–∏–µ:** –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **–§–æ—Ä–º—É–ª–∞:** `(total_open_notional + new_size) / (total_capital + new_size) <= max_exposure`
- **–†–∞—Å—á–µ—Ç total_capital:**
  - **Fixed mode:** `total_capital = initial_balance_sol` (—Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞)
  - **Dynamic mode:** `total_capital = available_balance + total_open_notional` (—Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (2025-01-XX):** –í fixed mode `total_capital` —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `initial_balance_sol`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö –ø–æ–∑–∏—Ü–∏–π

### `max_open_positions`

- **–ì–¥–µ:** `portfolio.max_open_positions` (YAML), `PortfolioConfig.max_open_positions` (–∫–æ–¥)
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `10` –≤ –∫–æ–¥–µ, `40` –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **–í–ª–∏—è–Ω–∏–µ:** –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç, –Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è (`trades_skipped_by_risk`)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `runner_reset_enabled`

- **–ì–¥–µ:** `portfolio.runner_reset_enabled` (YAML), `PortfolioConfig.runner_reset_enabled` (–∫–æ–¥)
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `False`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º Runner-XN: –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–µ–π XN –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ:** 
  - –ï—Å–ª–∏ `True` –∏ –ø–æ–∑–∏—Ü–∏—è –¥–æ—Å—Ç–∏–≥–∞–µ—Ç `runner_reset_multiple` (–Ω–∞–ø—Ä–∏–º–µ—Ä, x5), –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
  - –ü–æ—Å–ª–µ reset –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –≤—Ö–æ–¥—ã –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `runner_reset_multiple`

- **–ì–¥–µ:** `portfolio.runner_reset_multiple` (YAML), `PortfolioConfig.runner_reset_multiple` (–∫–æ–¥)
- **–¢–∏–ø:** `float`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `2.0` –≤ –∫–æ–¥–µ, `5.0` –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–Ω–æ–∂–∏—Ç–µ–ª—å XN –¥–ª—è runner reset (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5.0 = x5)
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `runner_reset_enabled=True`
- **–§–æ—Ä–º—É–ª–∞:** `multiplying_return = raw_exit_price / raw_entry_price >= runner_reset_multiple`
- **–í–∞–∂–Ω–æ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ **raw —Ü–µ–Ω–∞–º** –∏–∑ StrategyOutput (–±–µ–∑ slippage), –∞ –Ω–µ –ø–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Ü–µ–Ω–∞–º
- **–¢—Ä–∏–≥–≥–µ—Ä:** Reset –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏** (exit_time), –∞ –Ω–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Capacity Reset (v1.6)

#### `capacity_reset_enabled`

- **–ì–¥–µ:** `portfolio.capacity_reset_enabled` (YAML), `PortfolioConfig.capacity_reset_enabled` (–∫–æ–¥)
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `True`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å capacity reset: –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è –∏ –Ω–∏–∑–∫–æ–º turnover –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ:** 
  - –ï—Å–ª–∏ `True` –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ª–æ–≤–∏—è capacity pressure (–ø–æ—Ä—Ç—Ñ–µ–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω, –º–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –º–∞–ª–æ –∑–∞–∫—Ä—ã—Ç–∏–π), –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è market close
  - –ù–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç profit reset (–ø–æ equity threshold)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ capacity pressure
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_open_ratio_threshold`

- **–ì–¥–µ:** `portfolio.capacity_open_ratio_threshold` (YAML), `PortfolioConfig.capacity_open_ratio_threshold` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 1.0 = 100%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `1.0` (100%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ—Ä–æ–≥ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è –¥–ª—è capacity reset
- **–í–ª–∏—è–Ω–∏–µ:** Capacity reset —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `open_positions / max_open_positions >= capacity_open_ratio_threshold`
- **–§–æ—Ä–º—É–ª–∞:** `open_ratio = len(open_positions) / max_open_positions >= capacity_open_ratio_threshold`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._check_capacity_reset()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_window_days`

- **–ì–¥–µ:** `portfolio.capacity_window_days` (YAML), `PortfolioConfig.capacity_window_days` (–∫–æ–¥)
- **–¢–∏–ø:** `int` (–¥–Ω–∏)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `7`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–∫–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è capacity –º–µ—Ç—Ä–∏–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ `capacity_window_mode="time"`)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._update_capacity_tracking()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_blocked_signals_threshold`

- **–ì–¥–µ:** `portfolio.capacity_blocked_signals_threshold` (YAML), `PortfolioConfig.capacity_blocked_signals_threshold` (–∫–æ–¥)
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `200`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ—Ä–æ–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞ –æ–∫–Ω–æ –¥–ª—è capacity reset
- **–í–ª–∏—è–Ω–∏–µ:** Capacity reset —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `blocked_by_capacity_in_window >= capacity_blocked_signals_threshold`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._check_capacity_reset()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_min_turnover_threshold`

- **–ì–¥–µ:** `portfolio.capacity_min_turnover_threshold` (YAML), `PortfolioConfig.capacity_min_turnover_threshold` (–∫–æ–¥)
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `2`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫—Ä—ã—Ç–∏–π –∑–∞ –æ–∫–Ω–æ (–µ—Å–ª–∏ –±–æ–ª—å—à–µ, capacity reset –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç)
- **–í–ª–∏—è–Ω–∏–µ:** Capacity reset —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `closed_in_window <= capacity_min_turnover_threshold` (–Ω–∏–∑–∫–∏–π turnover)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._check_capacity_reset()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_window_mode`

- **–ì–¥–µ:** `portfolio.capacity_window_mode` (YAML), `PortfolioConfig.capacity_window_mode` (–∫–æ–¥)
- **–¢–∏–ø:** `Literal["time", "signals"]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"time"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∂–∏–º –æ–∫–Ω–∞ –¥–ª—è capacity –º–µ—Ç—Ä–∏–∫
  - `"time"` ‚Äî –æ–∫–Ω–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `capacity_window_days`)
  - `"signals"` ‚Äî –æ–∫–Ω–æ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–∏–≥–Ω–∞–ª–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `capacity_window_signals`)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–æ—Å–æ–± —Ä–∞—Å—á–µ—Ç–∞ –æ–∫–Ω–∞ –¥–ª—è capacity tracking
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._update_capacity_tracking()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

#### `capacity_window_signals`

- **–ì–¥–µ:** `portfolio.capacity_window_signals` (YAML), `PortfolioConfig.capacity_window_signals` (–∫–æ–¥)
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `300`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è –æ–∫–Ω–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ `capacity_window_mode="signals"`)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine._update_capacity_tracking()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

### `backtest_start` / `backtest_end`

- **–ì–¥–µ:** `backtest.start_at` / `backtest.end_at` (YAML), `PortfolioConfig.backtest_start` / `backtest_end` (–∫–æ–¥)
- **–¢–∏–ø:** `Optional[datetime]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –±—ç–∫—Ç–µ—Å—Ç–∞ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–¥–µ–ª–æ–∫ –ø–æ `entry_time`)
- **–í–ª–∏—è–Ω–∏–µ:** –°–¥–µ–ª–∫–∏ —Å `entry_time` –≤–Ω–µ –æ–∫–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- **–§–æ—Ä–º–∞—Ç:** ISO —Å—Ç—Ä–æ–∫–∞ –≤ UTC (`"2024-06-01T00:00:00Z"`)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `PortfolioEngine.simulate()` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–¥–µ–ª–æ–∫
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

---

## 3. Execution / Fees / Slippage

### `execution_profile`

- **–ì–¥–µ:** `portfolio.execution_profile` (YAML), CLI `--execution-profile`, `PortfolioConfig.execution_profile` (–∫–æ–¥)
- **–¢–∏–ø:** `str` ‚Äî `"realistic"` | `"stress"` | `"custom"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"realistic"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ—Ñ–∏–ª—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è slippage
- **–í–ª–∏—è–Ω–∏–µ:** –í—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ `fee.profiles` –¥–ª—è reason-based slippage multipliers
- **CLI –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** `--execution-profile` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç YAML –∫–æ–Ω—Ñ–∏–≥
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.from_config()`, `get_profile()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `swap_fee_pct`

- **–ì–¥–µ:** `portfolio.fee.swap_fee_pct` (YAML), `FeeModel.swap_fee_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.003 = 0.3%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.003` (0.3%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–∏—Å—Å–∏—è swap (–æ–±–º–µ–Ω —Ç–æ–∫–µ–Ω–æ–≤)
- **–í–ª–∏—è–Ω–∏–µ:** –í—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –Ω–æ—Ç–∏–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ (round-trip)
- **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –î–≤–∞–∂–¥—ã –∑–∞ —Å–¥–µ–ª–∫—É (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.apply_fees()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `lp_fee_pct`

- **–ì–¥–µ:** `portfolio.fee.lp_fee_pct` (YAML), `FeeModel.lp_fee_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.001 = 0.1%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.001` (0.1%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–∏—Å—Å–∏—è LP (liquidity provider)
- **–í–ª–∏—è–Ω–∏–µ:** –í—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –Ω–æ—Ç–∏–æ–Ω–∞–ª–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ (round-trip)
- **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –î–≤–∞–∂–¥—ã –∑–∞ —Å–¥–µ–ª–∫—É (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.apply_fees()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `network_fee_sol`

- **–ì–¥–µ:** `portfolio.fee.network_fee_sol` (YAML), `FeeModel.network_fee_sol` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (SOL)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.0005` SOL
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è —Å–µ—Ç–∏ Solana –≤ SOL
- **–í–ª–∏—è–Ω–∏–µ:** –í—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ (–Ω–µ –∏–∑ –Ω–æ—Ç–∏–æ–Ω–∞–ª–∞)
- **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –î–≤–∞–∂–¥—ã –∑–∞ —Å–¥–µ–ª–∫—É (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥) = `0.001` SOL total
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.network_fee()`, `PortfolioEngine.simulate()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `slippage_pct` (Legacy)

- **–ì–¥–µ:** `portfolio.fee.slippage_pct` (YAML), `FeeModel.slippage_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `Optional[float]` (–¥–æ–ª—è, 0.10 = 10%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.10` (10%) –≤ –∫–æ–¥–µ, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ –µ—Å—Ç—å `profiles`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Legacy —Ä–µ–∂–∏–º ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π slippage –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `profiles` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –û–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è entry, exit_tp, exit_sl, exit_timeout
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `FeeModel.effective_fee_pct()` (deprecated), `get_profile()` (legacy fallback)
- **–°—Ç–∞—Ç—É—Å:** üü° experimental / legacy
- **‚ö†Ô∏è –í–∞–∂–Ω–æ:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `profiles` –≤–º–µ—Å—Ç–æ `slippage_pct`

### `profiles` (Execution Profiles)

- **–ì–¥–µ:** `portfolio.fee.profiles` (YAML), `FeeModel.profiles` (–∫–æ–¥)
- **–¢–∏–ø:** `Optional[Dict[str, ExecutionProfileConfig]]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è legacy `slippage_pct`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Reason-based slippage multipliers –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
  ```yaml
  profiles:
    realistic:
      base_slippage_pct: 0.03
      slippage_multipliers:
        entry: 1.0
        exit_tp: 0.7
        exit_sl: 1.2
        exit_timeout: 0.3
        exit_manual: 0.5
  ```
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä–∞–∑–Ω—ã–π slippage –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∏—á–∏–Ω—ã –≤—ã—Ö–æ–¥–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.apply_entry()`, `ExecutionModel.apply_exit()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `base_slippage_pct` (–≤ –ø—Ä–æ—Ñ–∏–ª–µ)

- **–ì–¥–µ:** `portfolio.fee.profiles.{profile_name}.base_slippage_pct` (YAML), `ExecutionProfileConfig.base_slippage_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.03 = 3%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.03` (3%) –¥–ª—è `realistic`, `0.10` (10%) –¥–ª—è `stress`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤–æ–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
- **–í–ª–∏—è–Ω–∏–µ:** –£–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ `slippage_multipliers` –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
- **–§–æ—Ä–º—É–ª–∞:** `effective_slippage = base_slippage_pct * multiplier`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionProfileConfig.slippage_for()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `slippage_multipliers` (–≤ –ø—Ä–æ—Ñ–∏–ª–µ)

- **–ì–¥–µ:** `portfolio.fee.profiles.{profile_name}.slippage_multipliers` (YAML), `ExecutionProfileConfig.slippage_multipliers` (–∫–æ–¥)
- **–¢–∏–ø:** `Dict[str, float]`
- **–ö–ª—é—á–∏:**
  - `entry` ‚Äî slippage –ø—Ä–∏ –≤—Ö–æ–¥–µ
  - `exit_tp` ‚Äî slippage –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ TP
  - `exit_sl` ‚Äî slippage –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ SL
  - `exit_timeout` ‚Äî slippage –ø—Ä–∏ timeout
  - `exit_manual` ‚Äî slippage –ø—Ä–∏ —Ä—É—á–Ω–æ–º –≤—ã—Ö–æ–¥–µ
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ—Ñ–∏–ª—è (—Å–º. –ø—Ä–∏–º–µ—Ä—ã –≤ YAML)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ slippage –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–±—ã—Ç–∏—è
- **–í–ª–∏—è–Ω–∏–µ:** 
  - `exit_tp < 1.0` ‚Äî –º–µ–Ω—å—à–µ slippage –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ TP (–ª—É—á—à–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å)
  - `exit_sl > 1.0` ‚Äî –±–æ–ª—å—à–µ slippage –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ SL (–ø–∞–Ω–∏–∫–∞)
  - `exit_timeout < 1.0` ‚Äî –º–µ–Ω—å—à–µ slippage –ø—Ä–∏ timeout (–ø–ª–∞–Ω–æ–≤—ã–π –≤—ã—Ö–æ–¥)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ExecutionModel.apply_exit()` ‚Äî –º–∞–ø–ø–∏–Ω–≥ `reason` –Ω–∞ event
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ slippage –∫ —Ü–µ–Ω–∞–º

**–í—Ö–æ–¥ (–ø–æ–∫—É–ø–∫–∞):**
- `effective_entry_price = raw_entry_price * (1 + slippage)`
- –ü–ª–∞—Ç–∏–º –±–æ–ª—å—à–µ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ

**–í—ã—Ö–æ–¥ (–ø—Ä–æ–¥–∞–∂–∞):**
- `effective_exit_price = raw_exit_price * (1 - slippage)`
- –ü–æ–ª—É—á–∞–µ–º –º–µ–Ω—å—à–µ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ fees –∫ –Ω–æ—Ç–∏–æ–Ω–∞–ª—É:**
- `notional_after_fees = notional * (1 - swap_fee_pct - lp_fee_pct)`
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã (–≤—Ö–æ–¥ + –≤—ã—Ö–æ–¥)

---

## 4. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ (Strategy Parameters)

### RR Strategy

#### `tp_pct`

- **–ì–¥–µ:** `strategies[].params.tp_pct` (YAML), `RRStrategy.tp_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–ø—Ä–æ—Ü–µ–Ω—Ç—ã, 120 = 120%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `10` (10%) –≤ –∫–æ–¥–µ, –æ–±—ã—á–Ω–æ 120-500 –≤ YAML
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Take Profit –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
- **–í–ª–∏—è–Ω–∏–µ:** –¶–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞: `tp_price = entry_price * (1 + tp_pct / 100)`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `apply_rr_logic()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ `c.high >= tp_price`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `sl_pct`

- **–ì–¥–µ:** `strategies[].params.sl_pct` (YAML), `RRStrategy.sl_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–ø—Ä–æ—Ü–µ–Ω—Ç—ã, 15 = 15%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `10` (10%) –≤ –∫–æ–¥–µ, –æ–±—ã—á–Ω–æ 15-35 –≤ YAML
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Stop Loss –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
- **–í–ª–∏—è–Ω–∏–µ:** –¶–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞: `sl_price = entry_price * (1 - sl_pct / 100)`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `apply_rr_logic()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ `c.low <= sl_price`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `max_minutes`

- **–ì–¥–µ:** `strategies[].params.max_minutes` (YAML), `data.global_params.max_minutes` (–∫–æ–¥)
- **–¢–∏–ø:** `int` (–º–∏–Ω—É—Ç—ã)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `43200` (30 –¥–Ω–µ–π) –≤ –∫–æ–¥–µ, –æ–±—ã—á–Ω–æ `42000` –≤ YAML
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
- **–í–ª–∏—è–Ω–∏–µ:** –ï—Å–ª–∏ TP/SL –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏, –≤—ã—Ö–æ–¥ –ø–æ timeout –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–µ
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `apply_rr_logic()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ `minutes_from_entry > max_minutes`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `max_price_jump_pct`

- **–ì–¥–µ:** `strategies[].params.max_price_jump_pct` (YAML), `RRStrategy.max_price_jump_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–ø—Ä–æ—Ü–µ–Ω—Ç—ã, 0.5 = 0.5%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `0.5` (0.5%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å–∫–∞—á–æ–∫ —Ü–µ–Ω—ã –∑–∞ 1 –º–∏–Ω—É—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π
- **–í–ª–∏—è–Ω–∏–µ:** –ï—Å–ª–∏ `abs(candle.open - previous_candle.close) / previous_candle.close * 100 > max_price_jump_pct`, —Å–≤–µ—á–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–π
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `check_candle_quality()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤–µ—á–µ–π –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### RRD Strategy

#### `drawdown_entry_pct`

- **–ì–¥–µ:** `strategies[].params.drawdown_entry_pct` (YAML), `RRDStrategy.drawdown_entry_pct` (–∫–æ–¥)
- **–¢–∏–ø:** `float` (–ø—Ä–æ—Ü–µ–Ω—Ç—ã, 25 = 25%)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `25` (25%) –≤ –∫–æ–¥–µ, –æ–±—ã—á–Ω–æ 10-50 –≤ YAML
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ—Å–∞–¥–∫–∏ (drawdown) –æ—Ç –ø–µ—Ä–≤–æ–π —Å–≤–µ—á–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤—Ö–æ–¥
- **–í–ª–∏—è–Ω–∏–µ:** –¶–µ–ª–µ–≤–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞: `entry_price_target = first_candle.close * (1 - drawdown_entry_pct / 100)`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `RRDStrategy.on_signal()` ‚Äî –ø–æ–∏—Å–∫ —Å–≤–µ—á–∏ —Å `c.low <= entry_price_target`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `entry_wait_minutes`

- **–ì–¥–µ:** `strategies[].params.entry_wait_minutes` (YAML), `RRDStrategy.entry_wait_minutes` (–∫–æ–¥)
- **–¢–∏–ø:** `int` (–º–∏–Ω—É—Ç—ã)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `360` (6 —á–∞—Å–æ–≤) –≤ –∫–æ–¥–µ, –æ–±—ã—á–Ω–æ `180` (3 —á–∞—Å–∞) –≤ YAML
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤—Ö–æ–¥–∞ —Å –º–æ–º–µ–Ω—Ç–∞ —Å–∏–≥–Ω–∞–ª–∞
- **–í–ª–∏—è–Ω–∏–µ:** –ï—Å–ª–∏ –≤—Ö–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–æ `signal_time + entry_wait_minutes`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `no_entry`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `RRDStrategy.on_signal()` ‚Äî –¥–µ–¥–ª–∞–π–Ω –ø–æ–∏—Å–∫–∞ –≤—Ö–æ–¥–∞
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `tp_pct`, `sl_pct`, `max_minutes`, `max_price_jump_pct`

- **–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ RR Strategy** (—Å–º. –≤—ã—à–µ)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `RRDStrategy.on_signal()` ‚Äî –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è `apply_rr_logic()`

### Runner Strategy

- **–¢–∏–ø:** Stub —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (buy & hold)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç (–≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã)
- **–õ–æ–≥–∏–∫–∞:** –í—Ö–æ–¥ –Ω–∞ –ø–µ—Ä–≤–æ–π —Å–≤–µ—á–µ, –≤—ã—Ö–æ–¥ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

---

## 5. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Data Configuration)

### `loader`

- **–ì–¥–µ:** `data.loader` (YAML), `main.py` ‚Äî –≤—ã–±–æ—Ä –∑–∞–≥—Ä—É–∑—á–∏–∫–∞
- **–¢–∏–ø:** `str` ‚Äî `"csv"` | `"gecko"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"csv"` –≤ –∫–æ–¥–µ, `"gecko"` –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–≤–µ—á–µ–π
  - `"csv"` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ CSV —Ñ–∞–π–ª—ã
  - `"gecko"` ‚Äî –æ–Ω–ª–∞–π–Ω —á–µ—Ä–µ–∑ API GeckoTerminal
- **–í–ª–∏—è–Ω–∏–µ:** –í—ã–±–∏—Ä–∞–µ—Ç –∫–ª–∞—Å—Å –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (`CsvPriceLoader` –∏–ª–∏ `GeckoTerminalPriceLoader`)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `main.py` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ `price_loader`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `candles_dir`

- **–ì–¥–µ:** `data.candles_dir` (YAML), `CsvPriceLoader.__init__()` / `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"data/candles"` –¥–ª—è CSV, `"data/candles/cached"` –¥–ª—è Gecko
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞–ø–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è/–ø–æ–∏—Å–∫–∞ —Å–≤–µ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–í–ª–∏—è–Ω–∏–µ:** 
  - –î–ª—è CSV: –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º `{contract_address}_{timeframe}.csv`
  - –î–ª—è Gecko: –ø—É—Ç—å –∫ –∫–µ—à—É (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç: `{timeframe}/{contract_address}.csv`, —Å—Ç–∞—Ä—ã–π: `{contract_address}_{timeframe}.csv`)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `CsvPriceLoader._build_path()`, `GeckoTerminalPriceLoader._get_cache_path()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `timeframe`

- **–ì–¥–µ:** `data.timeframe` (YAML), `CsvPriceLoader.__init__()` / `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `str` ‚Äî `"1m"` | `"15m"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"1m"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–∞–π–º—Ñ—Ä–µ–π–º —Å–≤–µ—á–µ–π
  - `"1m"` ‚Äî –º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏
  - `"15m"` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ 15 –º–∏–Ω—É—Ç
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–≤–µ—á–µ–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–µ—à–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º, –∑–∞–ø—Ä–æ—Å—ã –∫ API GeckoTerminal
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `before_minutes`

- **–ì–¥–µ:** `data.before_minutes` (YAML), `BacktestRunner.__init__()`
- **–¢–∏–ø:** `int` (–º–∏–Ω—É—Ç—ã)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `60` (1 —á–∞—Å)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –î–û —Å–∏–≥–Ω–∞–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π: `start_time = signal_time - timedelta(minutes=before_minutes)`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `BacktestRunner._process_signal()` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `after_minutes`

- **–ì–¥–µ:** `data.after_minutes` (YAML), `BacktestRunner.__init__()`
- **–¢–∏–ø:** `int` (–º–∏–Ω—É—Ç—ã)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `360` (6 —á–∞—Å–æ–≤) –≤ –∫–æ–¥–µ, `43200` (30 –¥–Ω–µ–π) –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –ü–û–°–õ–ï —Å–∏–≥–Ω–∞–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω–µ—Ü –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π: `end_time = signal_time + timedelta(minutes=after_minutes)`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `BacktestRunner._process_signal()` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –í–∞–∂–Ω–æ:** –í YAML –ø—Ä–∏–º–µ—Ä–µ —É–∫–∞–∑–∞–Ω–æ `43200` (30 –¥–Ω–µ–π) –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –ø–æ–∑–∏—Ü–∏–∏ (`max_minutes`)

### `rate_limit.enabled`

- **–ì–¥–µ:** `data.rate_limit.enabled` (YAML), `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `True`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å rate limiting –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤ GeckoTerminal
- **–í–ª–∏—è–Ω–∏–µ:** –ï—Å–ª–∏ `True`, —Å–æ–∑–¥–∞–µ—Ç—Å—è `RateLimiter` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `GeckoTerminalPriceLoader.__init__()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ `rate_limiter`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `rate_limit.max_calls_per_minute`

- **–ì–¥–µ:** `data.rate_limit.max_calls_per_minute` (YAML), `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `30`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É (–ª–∏–º–∏—Ç free API GeckoTerminal)
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `RateLimiter(max_calls=...)` –¥–ª—è sliding window –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `RateLimiter.__init__()`, `GeckoTerminalPriceLoader.__init__()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `rate_limit.on_429`

- **–ì–¥–µ:** `data.rate_limit.on_429` (YAML), `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `str` ‚Äî `"wait"` | `"fail"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"wait"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP 429 (Rate Limit Exceeded)
  - `"wait"` ‚Äî –∂–¥–∞—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∑–∞–ø—Ä–æ—Å (—Å —É—á–µ—Ç–æ–º Retry-After –∑–∞–≥–æ–ª–æ–≤–∫–∞)
  - `"fail"` ‚Äî –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç (fail-fast)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ rate limit
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `retry_on_failure()` –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP 429 –æ—Ç–≤–µ—Ç–æ–≤
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `max_cache_age_days` (GeckoTerminalPriceLoader)

- **–ì–¥–µ:** `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `int` (–¥–Ω–∏)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `2`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –∫–µ—à–∞ –≤ –¥–Ω—è—Ö (–µ—Å–ª–∏ –∫–µ—à —Å—Ç–∞—Ä—à–µ, —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º)
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_is_cache_fresh()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–µ—à–∞
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `GeckoTerminalPriceLoader._is_cache_fresh()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ YAML, —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–¥

### `prefer_cache_if_exists` (GeckoTerminalPriceLoader)

- **–ì–¥–µ:** `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `True`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∂–∏–º cache-only: –µ—Å–ª–∏ –∫–µ—à –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ–≥–æ –±–µ–∑ API –∑–∞–ø—Ä–æ—Å–æ–≤
- **–í–ª–∏—è–Ω–∏–µ:** 
  - `True` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–µ—à –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (cache-only —Ä–µ–∂–∏–º)
  - `False` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∏ –¥–æ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `GeckoTerminalPriceLoader.load_prices()` ‚Äî –≤—ã–±–æ—Ä –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–µ—à–µ–º
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ YAML, —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–¥

### `strict_validation` (PriceLoader)

- **–ì–¥–µ:** `CsvPriceLoader.__init__()` / `GeckoTerminalPriceLoader.__init__()`
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `False`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–≤–µ—á–µ–π (–≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **–í–ª–∏—è–Ω–∏–µ:** 
  - `False` ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–≤–µ—á–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
  - `True` ‚Äî –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å–≤–µ—á–∏ –≤—ã–∑—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `validate_candle()` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable
- **‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ YAML, —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–æ–¥

### `output_dir` (Reporter)

- **–ì–¥–µ:** `report.output_dir` (YAML), `Reporter.__init__()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"output/reports"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ (JSON, CSV, HTML, PNG)
- **–í–ª–∏—è–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –æ—Ç—á–µ—Ç–æ–≤
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `Reporter.__init__()`, `main()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ `Reporter`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `parallel` (Runtime)

- **–ì–¥–µ:** `runtime.parallel` (YAML), `BacktestRunner.__init__()`
- **–¢–∏–ø:** `bool`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `False`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤
- **–í–ª–∏—è–Ω–∏–µ:** 
  - `False` ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
  - `True` ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ `ThreadPoolExecutor` (–µ—Å–ª–∏ `max_workers > 1`)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `BacktestRunner.run()` ‚Äî –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `max_workers` (Runtime)

- **–ì–¥–µ:** `runtime.max_workers` (YAML), CLI `--max-workers`, `BacktestRunner.__init__()`
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: Windows=1, Linux/mac=4)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ThreadPoolExecutor(max_workers=...)` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **CLI –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** `--max-workers` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç YAML –∏ –¥–µ—Ñ–æ–ª—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `BacktestRunner.__init__()`, `BacktestRunner.run()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `max_signals` (Runtime)

- **–ì–¥–µ:** `runtime.max_signals` (YAML)
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `100000` –≤ YAML –ø—Ä–∏–º–µ—Ä–µ
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—É—Å–∫–µ
- **–í–ª–∏—è–Ω–∏–µ:** ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ (–Ω–∞ –±—É–¥—É—â–µ–µ)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ù–µ—Ç (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
- **–°—Ç–∞—Ç—É—Å:** ‚ùì unclear (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

## 6. Stage A / B / C ‚Äî Research –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### Stage A: Window Aggregation

#### `DEFAULT_SPLITS`

- **–ì–¥–µ:** `backtester/research/window_aggregator.py`
- **–¢–∏–ø:** `List[int]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `[2, 3, 4, 5]`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–≤–Ω—ã—Ö –æ–∫–æ–Ω –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞ —Å–¥–µ–ª–æ–∫
- **–í–ª–∏—è–Ω–∏–µ:** –ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `split_2` = 2 –æ–∫–Ω–∞, `split_3` = 3 –æ–∫–Ω–∞)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `split_into_equal_windows()`, `aggregate_strategy_windows()`
- **CLI –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** `--splits 2 3 4 5` –≤ `run_stage_a.py`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `windows` (Legacy)

- **–ì–¥–µ:** `backtester/research/window_aggregator.py` ‚Äî `WINDOWS`
- **–¢–∏–ø:** `Dict[str, relativedelta]`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `{"6m": 6 months, "3m": 3 months, "2m": 2 months, "1m": 1 month}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Legacy —Ä–µ–∂–∏–º ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞
- **–í–ª–∏—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `split_counts` –Ω–µ —É–∫–∞–∑–∞–Ω
- **–°—Ç–∞—Ç—É—Å:** üî¥ legacy / deprecated

### Stage A: Stability Metrics

#### `survival_rate`

- **–ì–¥–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `calculate_stability_metrics()`
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.6 = 60%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–ª—è –æ–∫–æ–Ω —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º `total_pnl`
- **–§–æ—Ä–º—É–ª–∞:** `survival_rate = windows_positive / windows_total`
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (—Å–∫–æ–ª—å–∫–æ –æ–∫–æ–Ω –ø—Ä–∏–±—ã–ª—å–Ω—ã)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `build_stability_table()`, –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ –≤ Stage B
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `pnl_variance`

- **–ì–¥–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `calculate_stability_metrics()`
- **–¢–∏–ø:** `float` (–¥–∏—Å–ø–µ—Ä—Å–∏—è)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–∏—Å–ø–µ—Ä—Å–∏—è `total_pnl` –ø–æ –æ–∫–Ω–∞–º
- **–§–æ—Ä–º—É–ª–∞:** `statistics.variance(all_window_pnls)`
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–Ω–∏–∂–µ = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ –≤ Stage B
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `worst_window_pnl`

- **–ì–¥–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `calculate_stability_metrics()`
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, -0.15 = -15%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–∏—Ö—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–∫–Ω–µ (`min(all_window_pnls)`)
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ –≤ —Ö—É–¥—à–µ–º –æ–∫–Ω–µ
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ –≤ Stage B
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `median_window_pnl`

- **–ì–¥–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `calculate_stability_metrics()`
- **–¢–∏–ø:** `float` (–¥–æ–ª—è, 0.0 = 0%)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–µ–¥–∏–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –æ–∫–Ω–∞–º
- **–§–æ—Ä–º—É–ª–∞:** `statistics.median(all_window_pnls)`
- **–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—É—Å—Ç–æ–π—á–∏–≤–µ–µ –∫ –≤—ã–±—Ä–æ—Å–∞–º, —á–µ–º —Å—Ä–µ–¥–Ω–µ–µ)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ –≤ Stage B
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `windows_total`

- **–ì–¥–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ `calculate_stability_metrics()`
- **–¢–∏–ø:** `int`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **–í–ª–∏—è–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ –≤ Stage B (`min_windows`)
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Stage B: Selection Criteria

#### `DEFAULT_CRITERIA`

- **–ì–¥–µ:** `backtester/decision/selection_rules.py`
- **–¢–∏–ø:** `SelectionCriteria` (dataclass)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
  ```python
  SelectionCriteria(
      min_survival_rate=0.6,        # 60%
      max_pnl_variance=0.3,         # 0.3
      min_worst_window_pnl=-0.15,   # -15%
      min_median_window_pnl=0.0,    # 0%
      min_windows=3,                # 3 –æ–∫–Ω–∞
  )
  ```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (–≤—Å–µ —É—Å–ª–æ–≤–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)
- **–í–ª–∏—è–Ω–∏–µ:** –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:
  - `survival_rate >= min_survival_rate`
  - `pnl_variance <= max_pnl_variance`
  - `worst_window_pnl >= min_worst_window_pnl`
  - `median_window_pnl >= min_median_window_pnl`
  - `windows_total >= min_windows`
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `check_strategy_criteria()`, `select_strategies()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `DEFAULT_CRITERIA_V1`

- **–ì–¥–µ:** `backtester/decision/selection_rules.py`
- **–¢–∏–ø:** `SelectionCriteria` (dataclass)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
  ```python
  SelectionCriteria(
      min_survival_rate=0.60,       # 60%
      max_pnl_variance=0.15,        # 0.15
      min_worst_window_pnl=-0.25,   # -25%
      min_median_window_pnl=0.00,   # 0%
      min_windows=3,                 # 3 –æ–∫–Ω–∞
  )
  ```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ v1 –¥–ª—è Stage A (split_count 3/4/5) - –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø–æ—Ä–æ–≥–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Stage B –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (v1 —Ä–µ–∂–∏–º)
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `DEFAULT_RUNNER_CRITERIA_V1`

- **–ì–¥–µ:** `backtester/decision/selection_rules.py`
- **–¢–∏–ø:** `SelectionCriteria` (dataclass)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
  ```python
  SelectionCriteria(
      min_hit_rate_x2=0.35,         # 35% —Å–¥–µ–ª–æ–∫ –¥–æ–ª–∂–Ω—ã –¥–æ—Å—Ç–∏—á—å x2
      min_hit_rate_x5=0.08,         # 8% —Å–¥–µ–ª–æ–∫ –¥–æ–ª–∂–Ω—ã –¥–æ—Å—Ç–∏—á—å x5
      max_p90_hold_days=35.0,       # 90-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å <= 35 –¥–Ω–µ–π
      max_tail_contribution=0.80,    # –ú–∞–∫—Å–∏–º—É–º 80% PnL –æ—Ç —Å–¥–µ–ª–æ–∫ —Å realized_multiple >= 5x
      max_drawdown_pct=-0.60,       # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –Ω–µ –±–æ–ª–µ–µ 60%
  )
  ```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö—Ä–∏—Ç–µ—Ä–∏–∏ v1 –¥–ª—è Runner —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (fixed/1%/exposure=0.95/100 pos/no reset)
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Stage B –¥–ª—è Runner —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (v1 —Ä–µ–∂–∏–º)
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

---

## 7. CLI –∞—Ä–≥—É–º–µ–Ω—Ç—ã

### `--signals`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"signals/example_signals.csv"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `CsvSignalLoader.load_signals()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--strategies-config`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"config/strategies_example.yaml"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** YAML-—Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `load_strategies()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--backtest-config`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"config/backtest_example.yaml"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** YAML-—Ñ–∞–π–ª —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –±—ç–∫—Ç–µ—Å—Ç–∞
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `load_yaml()`, `BacktestRunner.__init__()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--json-output`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"output/results.json"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON-–æ—Ç—á–µ—Ç–∞
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `main()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—â–µ–≥–æ JSON —Ñ–∞–π–ª–∞
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--max-workers`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: Windows=1, Linux/mac=4)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `BacktestRunner.__init__()`, `ThreadPoolExecutor(max_workers=...)`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--report-mode`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` ‚Äî `"none"` | `"summary"` | `"top"` | `"all"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"summary"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤
  - `none` ‚Äî —Ç–æ–ª—å–∫–æ `results.json`
  - `summary` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ summary CSV
  - `top` ‚Äî top-N —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ –º–µ—Ç—Ä–∏–∫–µ
  - `all` ‚Äî –≤—Å–µ –æ—Ç—á–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `main()` ‚Äî –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--report-top-n`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `50`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–ø —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `--report-mode top`)
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `select_top_strategies()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--report-metric`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` ‚Äî `"portfolio_return"` | `"strategy_total_pnl"` | `"sharpe"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"portfolio_return"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ top-N —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å `--report-mode top`)
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `select_top_strategies()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--no-charts`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `bool` (—Ñ–ª–∞–≥)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ `--report-mode`: True –¥–ª—è none/summary/top, False –¥–ª—è all)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å PNG –≥—Ä–∞—Ñ–∏–∫–∏
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ConditionalReporter.generate_full_report()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--no-html`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `bool` (—Ñ–ª–∞–≥)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ `--report-mode`: True –¥–ª—è none/summary/top, False –¥–ª—è all)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å HTML –æ—Ç—á–µ—Ç—ã
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `ConditionalReporter.generate_full_report()`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `--execution-profile`

- **–ì–¥–µ:** `main.py` ‚Äî `parse_args()`
- **–¢–∏–ø:** `str` ‚Äî `"realistic"` | `"stress"` | `"custom"`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ YAML)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Execution profile –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è slippage (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç YAML –∫–æ–Ω—Ñ–∏–≥)
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `main()` ‚Äî –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `backtest_cfg["portfolio"]["execution_profile"]`
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Stage A CLI (`run_stage_a.py`)

#### `--reports-dir`

- **–ì–¥–µ:** `backtester/research/run_stage_a.py`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"output/reports"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å `*_trades.csv` —Ñ–∞–π–ª–∞–º–∏
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `--splits`

- **–ì–¥–µ:** `backtester/research/run_stage_a.py`
- **–¢–∏–ø:** `List[int]` (nargs="+")
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `DEFAULT_SPLITS = [2, 3, 4, 5]`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π split_n –¥–ª—è —Ä–∞–≤–Ω—ã—Ö –æ–∫–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `--splits 2 3 4 5`)
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Stage B CLI (`run_stage_b.py`)

#### `--stability-csv`

- **–ì–¥–µ:** `backtester/decision/run_stage_b.py`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `"output/reports/strategy_stability.csv"`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É—Ç—å –∫ `strategy_stability.csv` –∏–∑ Stage A
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

#### `--output-csv`

- **–ì–¥–µ:** `backtester/decision/run_stage_b.py`
- **–¢–∏–ø:** `str` (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `None` (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–∞–∫ `strategy_selection.csv`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `strategy_selection.csv`
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π:** –ù–µ—Ç
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

---

## 8. CSV / Data schema

### Signals CSV

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:**
- `id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–∞ (str)
- `contract_address` ‚Äî –∞–¥—Ä–µ—Å —Ç–æ–∫–µ–Ω–∞/–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ (str)
- `timestamp` ‚Äî ISO-–≤—Ä–µ–º—è —Å–∏–≥–Ω–∞–ª–∞ –≤ UTC (datetime)

**–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:**
- `source` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª–∞ (str, default: `"unknown"`)
- `narrative` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (str, default: `""`)
- `extra_json` ‚Äî JSON-—Å—Ç—Ä–æ–∫–∞ —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (dict)
- –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –∫–æ–ª–æ–Ω–∫–∏ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `Signal.extra`

**–ü—Ä–∏–º–µ—Ä:**
```csv
id,contract_address,timestamp,source,narrative,total_supply
test1,ABC123...,2024-06-01T00:00:00Z,tg:12345,Test signal,1000000000
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `CsvSignalLoader.load_signals()`

### Trades CSV (output)

**–ö–æ–ª–æ–Ω–∫–∏:**
- `signal_id` ‚Äî ID —Å–∏–≥–Ω–∞–ª–∞
- `contract_address` ‚Äî –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- `entry_time` ‚Äî –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞ (datetime)
- `exit_time` ‚Äî –≤—Ä–µ–º—è –≤—ã—Ö–æ–¥–∞ (datetime)
- `entry_price` ‚Äî —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞ (float)
- `exit_price` ‚Äî —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞ (float)
- `pnl_pct` ‚Äî –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (float, 10.5 = 10.5%)
- `reason` ‚Äî –ø—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞: `"tp"` | `"sl"` | `"timeout"` | `"no_entry"` | `"error"`
- `source` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª–∞ (str)
- `narrative` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ (str)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `Reporter.save_trades_table()`, Stage A (`load_trades_csv()`)

### Portfolio Positions CSV (output) ‚Äî v1.6

**–§–∞–π–ª:** `portfolio_positions.csv` (positions-level, –∞–≥—Ä–µ–≥–∞—Ç –ø–æ signal_id+strategy+contract)

**–ö–æ–ª–æ–Ω–∫–∏:**
- `strategy` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (str)
- `signal_id` ‚Äî ID —Å–∏–≥–Ω–∞–ª–∞
- `contract_address` ‚Äî –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- `entry_time` ‚Äî –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞ (ISO datetime)
- `exit_time` ‚Äî –≤—Ä–µ–º—è –≤—ã—Ö–æ–¥–∞ (ISO datetime)
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å: `"closed"` (—Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏)
- `size` ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ SOL (float)
- `pnl_sol` ‚Äî –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫ –≤ SOL (float, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- `fees_total_sol` ‚Äî —Å—É–º–º–∞—Ä–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏ –≤ SOL (float)
- `exec_entry_price` ‚Äî –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞ —Å slippage (float)
- `exec_exit_price` ‚Äî –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞ —Å slippage (float)
- `raw_entry_price` ‚Äî —Å—ã—Ä–∞—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞ –±–µ–∑ slippage (float)
- `raw_exit_price` ‚Äî —Å—ã—Ä–∞—è —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞ –±–µ–∑ slippage (float)
- `closed_by_reset` ‚Äî –∑–∞–∫—Ä—ã—Ç–∞ –ª–∏ –ø–æ–∑–∏—Ü–∏—è –ø–æ reset (bool)
- `triggered_portfolio_reset` ‚Äî —Ç—Ä–∏–≥–≥–µ—Ä–Ω—É–ª–∞ –ª–∏ portfolio-level reset (bool)
- `reset_reason` ‚Äî –ø—Ä–∏—á–∏–Ω–∞ reset: `"profit"` | `"capacity"` | `"runner"` | `"manual"` | `"none"` (str)
- `hold_minutes` ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö (int)

**–í–∞–∂–Ω–æ:** 
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = 1 Position (–∞–≥—Ä–µ–≥–∞—Ç, –±–µ–∑ –¥—É–±–ª–µ–π –ø–æ signal_id+strategy+contract)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Stage A –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –¢–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (status="closed")

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `Reporter.save_portfolio_positions_table()`, Stage A (`run_stage_a.py`)

### Portfolio Executions CSV (output) ‚Äî v1.6

**–§–∞–π–ª:** `portfolio_executions.csv` (executions-level, –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ = –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)

**–ö–æ–ª–æ–Ω–∫–∏:**
- `signal_id` ‚Äî ID —Å–∏–≥–Ω–∞–ª–∞
- `strategy` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- `event_time` ‚Äî –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è (ISO datetime)
- `event_type` ‚Äî —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è: `"entry"` | `"partial_exit"` | `"final_exit"` | `"force_close_reset"` (str)
- `qty_delta` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (float, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –¥–ª—è entry, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –¥–ª—è exit)
- `raw_price` ‚Äî —Å—ã—Ä–∞—è —Ü–µ–Ω–∞ –±–µ–∑ slippage (float)
- `exec_price` ‚Äî –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞ —Å slippage (float)
- `fees_sol` ‚Äî –∫–æ–º–∏—Å—Å–∏–∏ –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (float)
- `pnl_sol_delta` ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ PnL –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (float)
- `reset_reason` ‚Äî –ø—Ä–∏—á–∏–Ω–∞ reset (–µ—Å–ª–∏ force close): `"profit"` | `"capacity"` | `"runner"` | `None` (str)

**–í–∞–∂–Ω–æ:**
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = 1 execution event (entry, partial exit, final exit, force close)
- –û–¥–∏–Ω signal_id –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ (–µ—Å–ª–∏ –±—ã–ª–∏ partial exits)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–µ–±–∞–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** `Reporter.save_portfolio_executions_table()`

### Strategy Stability CSV (Stage A output)

**–ö–æ–ª–æ–Ω–∫–∏:**
- `strategy` ‚Äî –∏–º—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (str)
- `split_count` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω —Ä–∞–∑–±–∏–µ–Ω–∏—è (int)
- `survival_rate` ‚Äî –¥–æ–ª—è –æ–∫–æ–Ω —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º PnL (float)
- `pnl_variance` ‚Äî –¥–∏—Å–ø–µ—Ä—Å–∏—è PnL –ø–æ –æ–∫–Ω–∞–º (float)
- `worst_window_pnl` ‚Äî –Ω–∞–∏—Ö—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–∫–Ω–µ (float)
- `best_window_pnl` ‚Äî –Ω–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–∫–Ω–µ (float)
- `median_window_pnl` ‚Äî –º–µ–¥–∏–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (float)
- `windows_positive` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –æ–∫–æ–Ω (int)
- `windows_total` ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω (int)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Stage B (`load_stability_csv()`)

### Strategy Selection CSV (Stage B output)

**–ö–æ–ª–æ–Ω–∫–∏:**
- –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–∑ `strategy_stability.csv`
- `passed` ‚Äî –ø—Ä–æ—à–ª–∞ –ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞ (bool)
- `failed_reasons` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (List[str], –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫—É –¥–ª—è CSV)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç–±–æ—Ä–∞

---

## 9. Flags / Modes / Switches

### `allocation_mode`

- **–¢–∏–ø:** `Literal["fixed", "dynamic"]`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω:**
  - `fixed`: —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ = `initial_balance_sol * percent_per_trade` (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π)
  - `dynamic`: —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ = `current_balance * percent_per_trade` (compound effect)
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `runner_reset_enabled`

- **–¢–∏–ø:** `bool`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω:**
  - `False`: –æ–±—ã—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
  - `True`: –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏–µ–π `runner_reset_multiple` (–ø–æ raw —Ü–µ–Ω–∞–º, –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏) –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏, –≤—Ö–æ–¥—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
  - Reset –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏ (exit_time), –∞ –Ω–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### `capacity_reset_enabled` (v1.6)

- **–¢–∏–ø:** `bool`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω:**
  - `False`: capacity reset –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
  - `True`: –ø—Ä–∏ capacity pressure (–ø–æ—Ä—Ç—Ñ–µ–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω, –º–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤, –º–∞–ª–æ –∑–∞–∫—Ä—ã—Ç–∏–π) –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ market close
  - –ù–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç profit reset (–ø–æ equity threshold)
  - –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ —á–µ—Ä–µ–∑ execution_model (–Ω–µ pnl=0)
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable (v1.6)

### `execution_profile`

- **–¢–∏–ø:** `str` ‚Äî `"realistic"` | `"stress"` | `"custom"`
- **–í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω:**
  - –í—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ `fee.profiles` –¥–ª—è reason-based slippage
  - –ú–µ–Ω—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
  - –í–ª–∏—è–µ—Ç –Ω–∞ PnL –∏ equity curve
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Legacy vs New Behaviour

#### Legacy —Ä–µ–∂–∏–º (slippage_pct)

- **–£—Å–ª–æ–≤–∏–µ:** `fee.profiles` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, `fee.slippage_pct` —É–∫–∞–∑–∞–Ω
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –û–¥–∏–Ω–∞–∫–æ–≤—ã–π slippage –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π (entry, exit_tp, exit_sl, exit_timeout)
- **–°—Ç–∞—Ç—É—Å:** üü° experimental / legacy

#### New —Ä–µ–∂–∏–º (profiles)

- **–£—Å–ª–æ–≤–∏–µ:** `fee.profiles` —É–∫–∞–∑–∞–Ω
- **–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** Reason-based slippage multipliers –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–°—Ç–∞—Ç—É—Å:** üü¢ stable

### Stress vs Realistic

#### `realistic` –ø—Ä–æ—Ñ–∏–ª—å

- **base_slippage_pct:** `0.03` (3%)
- **multipliers:** `entry: 1.0`, `exit_tp: 0.7`, `exit_sl: 1.2`, `exit_timeout: 0.3`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –ª–∏–∫–≤–∏–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

#### `stress` –ø—Ä–æ—Ñ–∏–ª—å

- **base_slippage_pct:** `0.10` (10%)
- **multipliers:** `entry: 1.0`, `exit_tp: 0.6`, `exit_sl: 1.3`, `exit_timeout: 0.2`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Stress test –¥–ª—è low-cap —Ç–æ–∫–µ–Ω–æ–≤ —Å –Ω–∏–∑–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é

---

## 10. –°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –£—Å–∏–ª–∏–≤–∞—é—â–∏–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

1. **High slippage + High trade frequency**
   - –í—ã—Å–æ–∫–∏–π `base_slippage_pct` + –º–Ω–æ–≥–æ —Å–¥–µ–ª–æ–∫ = –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∏–∑–¥–µ—Ä–∂–µ–∫
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–Ω–∏–∑–∏—Ç—å `percent_per_trade` –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å `max_exposure`

2. **Small TP + Stress execution**
   - –ú–∞–ª–µ–Ω—å–∫–∏–π `tp_pct` + `stress` –ø—Ä–æ—Ñ–∏–ª—å = –≤—ã—Å–æ–∫–∏–π slippage –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –ø–æ TP
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `realistic` –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å `tp_pct`

3. **Dynamic allocation + High max_exposure**
   - `allocation_mode="dynamic"` + `max_exposure=0.9` = –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–æ—Å—Ç/–ø–∞–¥–µ–Ω–∏–µ
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–Ω–∏–∑–∏—Ç—å `max_exposure` –¥–ª—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### –û–ø–∞—Å–Ω–æ –º–µ–Ω—è—Ç—å –≤–º–µ—Å—Ç–µ

1. **`allocation_mode` + `percent_per_trade`**
   - –ü—Ä–∏ `dynamic` –∏–∑–º–µ–Ω–µ–Ω–∏–µ `percent_per_trade` –≤–ª–∏—è–µ—Ç –Ω–∞ compound effect
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–º–µ—Å—Ç–µ

2. **`execution_profile` + `tp_pct` / `sl_pct`**
   - –†–∞–∑–Ω—ã–π slippage –º–µ–Ω—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ü–µ–Ω—ã TP/SL
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å TP/SL –ø—Ä–∏ —Å–º–µ–Ω–µ –ø—Ä–æ—Ñ–∏–ª—è

3. **`runner_reset_multiple` + `max_open_positions`**
   - –ù–∏–∑–∫–∏–π `runner_reset_multiple` + –≤—ã—Å–æ–∫–∏–π `max_open_positions` = —á–∞—Å—Ç—ã–µ resets
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –ü—Ä–∏–º–µ—Ä—ã "–ø–ª–æ—Ö–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π"

1. **`slippage_pct=0.10` + `tp_pct=50` + `stress` –ø—Ä–æ—Ñ–∏–ª—å**
   - –í—ã—Å–æ–∫–∏–π slippage —Å—ä–µ–¥–∞–µ—Ç –º–∞–ª–µ–Ω—å–∫—É—é –ø—Ä–∏–±—ã–ª—å
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∏–∑–∫–∏–π winrate, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π PnL

2. **`allocation_mode="dynamic"` + `max_exposure=1.0` + `percent_per_trade=0.5`**
   - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫, –±–æ–ª—å—à–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

3. **`runner_reset_enabled=True` + `runner_reset_multiple=2.0` + –º–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π**
   - –ß–∞—Å—Ç—ã–µ resets –ø—Ä–µ—Ä—ã–≤–∞—é—Ç —Ä–∞–±–æ—Ç—É —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∏–∑–∫–∏–π `trades_executed`, –ø—Ä–æ–ø—É—Å–∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

---

## 11. –°—Ç–∞—Ç—É—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### üü¢ Stable

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã –∏ –Ω–µ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é:

- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—Ä—Ç—Ñ–µ–ª—è (`initial_balance_sol`, `allocation_mode`, `percent_per_trade`, `max_exposure`, `max_open_positions`)
- Execution profiles (`execution_profile`, `profiles`, `base_slippage_pct`, `slippage_multipliers`)
- –ö–æ–º–∏—Å—Å–∏–∏ (`swap_fee_pct`, `lp_fee_pct`, `network_fee_sol`)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–π (`tp_pct`, `sl_pct`, `max_minutes`, `drawdown_entry_pct`, `entry_wait_minutes`)
- Stage A/B –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`DEFAULT_SPLITS`, `DEFAULT_CRITERIA`)
- CLI –∞—Ä–≥—É–º–µ–Ω—Ç—ã
- CSV —Å—Ö–µ–º—ã

### üü° Experimental / Legacy

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–∏:

- `slippage_pct` (legacy —Ä–µ–∂–∏–º) ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `profiles`
- `windows` (legacy —Ä–µ–∂–∏–º –≤ `window_aggregator.py`) ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `split_counts`

### üî¥ Deprecated

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏ –∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:

- –ù–µ—Ç (–Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞)

### ‚ùì Unclear

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç—Ä–µ–±—É—é—â–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è:

- –ù–µ—Ç (–Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞)

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ë—ã—Å—Ç—Ä—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫

### –ì–¥–µ –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | YAML –ø—É—Ç—å | –ö–æ–¥ (–¥–µ—Ñ–æ–ª—Ç) |
|----------|-----------|--------------|
| –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å | `portfolio.initial_balance_sol` | `PortfolioConfig.initial_balance_sol = 10.0` |
| –†–µ–∂–∏–º –∞–ª–ª–æ–∫–∞—Ü–∏–∏ | `portfolio.allocation_mode` | `PortfolioConfig.allocation_mode = "dynamic"` |
| –î–æ–ª—è –Ω–∞ —Å–¥–µ–ª–∫—É | `portfolio.percent_per_trade` | `PortfolioConfig.percent_per_trade = 0.1` |
| –ú–∞–∫—Å. —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è | `portfolio.max_exposure` | `PortfolioConfig.max_exposure = 0.5` |
| –ú–∞–∫—Å. –ø–æ–∑–∏—Ü–∏–π | `portfolio.max_open_positions` | `PortfolioConfig.max_open_positions = 10` |
| Capacity reset enabled | `portfolio.capacity_reset_enabled` | `PortfolioConfig.capacity_reset_enabled = True` |
| Capacity open ratio threshold | `portfolio.capacity_open_ratio_threshold` | `PortfolioConfig.capacity_open_ratio_threshold = 1.0` |
| Capacity window days | `portfolio.capacity_window_days` | `PortfolioConfig.capacity_window_days = 7` |
| Capacity blocked signals threshold | `portfolio.capacity_blocked_signals_threshold` | `PortfolioConfig.capacity_blocked_signals_threshold = 200` |
| Capacity min turnover threshold | `portfolio.capacity_min_turnover_threshold` | `PortfolioConfig.capacity_min_turnover_threshold = 2` |
| Capacity window mode | `portfolio.capacity_window_mode` | `PortfolioConfig.capacity_window_mode = "time"` |
| Capacity window signals | `portfolio.capacity_window_signals` | `PortfolioConfig.capacity_window_signals = 300` |
| Execution profile | `portfolio.execution_profile` | `PortfolioConfig.execution_profile = "realistic"` |
| Swap fee | `portfolio.fee.swap_fee_pct` | `FeeModel.swap_fee_pct = 0.003` |
| LP fee | `portfolio.fee.lp_fee_pct` | `FeeModel.lp_fee_pct = 0.001` |
| Network fee | `portfolio.fee.network_fee_sol` | `FeeModel.network_fee_sol = 0.0005` |
| Base slippage | `portfolio.fee.profiles.{profile}.base_slippage_pct` | `ExecutionProfileConfig.base_slippage_pct = 0.03` |
| TP % | `strategies[].params.tp_pct` | `RRStrategy.tp_pct = 0.1` |
| SL % | `strategies[].params.sl_pct` | `RRStrategy.sl_pct = 0.1` |
| Max minutes | `strategies[].params.max_minutes` | `43200` (30 –¥–Ω–µ–π) |
| Drawdown entry | `strategies[].params.drawdown_entry_pct` | `RRDStrategy.drawdown_entry_pct = 0.25` |
| Entry wait | `strategies[].params.entry_wait_minutes` | `RRDStrategy.entry_wait_minutes = 360` |
| Timeframe | `data.timeframe` | `"1m"` |
| Before minutes | `data.before_minutes` | `60` |
| After minutes | `data.after_minutes` | `360` (–∫–æ–¥) / `43200` (YAML) |
| Rate limit enabled | `data.rate_limit.enabled` | `True` |
| Rate limit max calls | `data.rate_limit.max_calls_per_minute` | `30` |
| Rate limit on_429 | `data.rate_limit.on_429` | `"wait"` |
| Output dir | `report.output_dir` | `"output/reports"` |
| Parallel | `runtime.parallel` | `False` |
| Max workers | `runtime.max_workers` | `None` (auto) |

---

**–ö–æ–Ω–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞**





