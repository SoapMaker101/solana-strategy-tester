# üìå Project v1.5 Refactoring Report

**–î–∞—Ç–∞:** 2025-12-17  
**–í–µ—Ä—Å–∏—è:** 1.5  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω

---

## üéØ –¶–µ–ª—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

–°–¥–µ–ª–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–µ–∫—Ç–∞, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–≤ –µ–≥–æ –∫–∞–∫ —Å—Ç–∞–±–∏–ª—å–Ω—É—é, —Ç–µ—Å—Ç-–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π:
- –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–∑ —Ç–µ—Å—Ç–æ–≤
- –õ—é–±—ã–µ reset / runner / portfolio-–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞—Ä—É—à–∏—Ç—å
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π, —á–∏—Ç–∞–µ–º–æ–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–π

---

## üîí –ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø

**Tests are the spec. Code must obey tests, not vice versa.**

---

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å `portfolio_reset.py`

**–§–∞–π–ª:** `backtester/domain/portfolio_reset.py`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
- `ResetReason` (Enum) - —á—ë—Ç–∫–∏–µ –ø—Ä–∏—á–∏–Ω—ã reset:
  - `EQUITY_THRESHOLD` - Portfolio equity –¥–æ—Å—Ç–∏–≥–ª–æ –ø–æ—Ä–æ–≥–∞
  - `RUNNER_XN` - Runner –ø–æ–∑–∏—Ü–∏—è –¥–æ—Å—Ç–∏–≥–ª–∞ XN —É—Ä–æ–≤–Ω—è
  - `MANUAL` - –†—É—á–Ω–æ–π reset (–¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
  
- `PortfolioResetContext` - –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è reset –æ–ø–µ—Ä–∞—Ü–∏–∏:
  - –ü—Ä–∏—á–∏–Ω–∞ reset
  - –í—Ä–µ–º—è reset
  - Marker position (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)
  - –ü–æ–∑–∏—Ü–∏–∏ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
  
- `PortfolioState` - –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç –≤—Å—ë –∏–∑–º–µ–Ω—è–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è:
  - `balance`, `peak_balance`
  - `open_positions`, `closed_positions`
  - `equity_curve`
  - `reset_count`, `last_reset_time`
  - `cycle_start_equity`, `equity_peak_in_cycle`
  - `reset_until`
  - –ú–µ—Ç–æ–¥—ã: `current_equity()`, `update_equity_peak()`

- `apply_portfolio_reset()` - **–ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø —Ç–æ—á–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è reset**

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã, –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –≤ `apply_portfolio_reset()`:**
1. ‚úÖ marker_position –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–æ–º–µ—á–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–∞–º–∏ reset
2. ‚úÖ –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ `positions_to_force_close` –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è (pnl=0)
3. ‚úÖ `reset_count` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1
4. ‚úÖ `cycle_start_equity` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–∏–π balance
5. ‚úÖ `equity_peak_in_cycle` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ `cycle_start_equity`
6. ‚úÖ meta –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `setdefault`/`update`)

### 2. –£–ª—É—á—à–µ–Ω –∫–ª–∞—Å—Å `Position`

**–§–∞–π–ª:** `backtester/domain/position.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `PositionStatus` (Enum) - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å
- `__post_init__()` - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ `meta` –≤—Å–µ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- Helper-–º–µ—Ç–æ–¥—ã:
  - `mark_closed_by_reset()` - –ø–æ–º–µ—á–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∫–∞–∫ –∑–∞–∫—Ä—ã—Ç—É—é –ø–æ reset
  - `mark_triggered_reset()` - –ø–æ–º–µ—á–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∫–∞–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—É—é –¥–ª—è runner reset
  - `mark_triggered_portfolio_reset()` - –ø–æ–º–µ—á–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∫–∞–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—É—é –¥–ª—è portfolio reset
  - `is_closed_by_reset()`, `has_triggered_reset()`, `has_triggered_portfolio_reset()` - –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã:**
- ‚úÖ Position - —ç—Ç–æ identity: –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –∂–∏–≤–µ—Ç –æ—Ç entry –¥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ result
- ‚úÖ `meta` –≤—Å–µ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ None)
- ‚úÖ `meta` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ `setdefault`/`update`, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º `meta = ...`

### 3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `portfolio.py`

**–§–∞–π–ª:** `backtester/domain/portfolio.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

#### 3.1. –£–¥–∞–ª—ë–Ω —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ `_process_portfolio_level_reset()`
- ‚ùå –£–¥–∞–ª—ë–Ω –º–µ—Ç–æ–¥ —Å 155 —Å—Ç—Ä–æ–∫–∞–º–∏ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- ‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `apply_portfolio_reset()` —á–µ—Ä–µ–∑ `_apply_reset()`

#### 3.2. –í–≤–µ–¥—ë–Ω `PortfolioState` –≤ –º–µ—Ç–æ–¥ `simulate()`
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ `PortfolioState` –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ –í—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `state.*`
- ‚úÖ –ö–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–º

#### 3.3. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ reset-–ª–æ–≥–∏–∫–∞
- ‚úÖ –í—Å–µ reset –æ–ø–µ—Ä–∞—Ü–∏–∏ (portfolio-level –∏ runner XN) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —á–µ—Ä–µ–∑ `_apply_reset()`
- ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ force-close —É–¥–∞–ª–µ–Ω–æ
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è `reset_count`, `cycle_start_equity`, `equity_peak_in_cycle`

#### 3.4. –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ marker position
- ‚úÖ Marker position –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á—ë—Ç–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ reset
- ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `PortfolioResetContext.__post_init__()`

---

## üî¥ –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

### Portfolio Reset Invariants

1. ‚úÖ **–ï—Å–ª–∏ `reset_count > 0` ‚Üí –≤ `result.positions` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –ø–æ–∑–∏—Ü–∏—è —Å `meta["closed_by_reset"] == True`**
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `apply_portfolio_reset()`: –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ `positions_to_force_close` –ø–æ–º–µ—á–∞—é—Ç—Å—è —Ñ–ª–∞–≥–æ–º

2. ‚úÖ **–õ—é–±–æ–π reset –æ–±—è–∑–∞–Ω –∏–º–µ—Ç—å marker_position**
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `PortfolioResetContext.__post_init__()`: `ValueError` –µ—Å–ª–∏ `marker_position is None`

3. ‚úÖ **marker –æ–±—è–∑–∞–Ω–∞ –ø–æ–ø–∞—Å—Ç—å –≤ `result.positions`**
   - Marker position –ø–æ–º–µ—á–∞–µ—Ç—Å—è —Ñ–ª–∞–≥–∞–º–∏, –Ω–æ –ù–ï force-close (–æ–Ω–∞ –ª–∏–±–æ —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞, –ª–∏–±–æ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –ª–æ–≥–∏–∫–æ–π –≤—ã–±–æ—Ä–∞ marker –≤ `simulate()`

4. ‚úÖ **meta –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è**
   - –ó–∞–ø—Ä–µ—â–µ–Ω–æ: `pos.meta = {...}` –∏–ª–∏ `pos.meta = pos.meta or {}`
   - –†–∞–∑—Ä–µ—à–µ–Ω–æ —Ç–æ–ª—å–∫–æ: `pos.meta.setdefault(...)` –∏–ª–∏ `pos.meta.update(...)`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `apply_portfolio_reset()` –∏ helper-–º–µ—Ç–æ–¥–∞—Ö `Position`

5. ‚úÖ **Position ‚Äî —ç—Ç–æ identity**
   - –û–¥–∏–Ω –æ–±—ä–µ–∫—Ç Position –∂–∏–≤—ë—Ç –æ—Ç entry –¥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ result
   - –ù–∏–∫–∞–∫–∏—Ö –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–π `Position(...)` –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ "–¥–æ" –∏ "–ø–æ—Å–ª–µ"

### –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:

```python
# ‚ùå Reset-–ª–æ–≥–∏–∫–∞ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –≤ 5+ –º–µ—Å—Ç–∞—Ö
# ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ force-close –∫–æ–¥–∞
# ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è reset_count
# ‚ùå –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ marker_position
# ‚ùå –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ meta –ø—Ä–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è—Ö
```

### –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:

```python
# ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ reset: apply_portfolio_reset()
# ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
# ‚úÖ –û–¥–Ω–∞ —Ç–æ—á–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è reset_count, cycle_start_equity, equity_peak_in_cycle
# ‚úÖ –ß—ë—Ç–∫–∞—è –ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ PortfolioResetContext
# ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å meta —á–µ—Ä–µ–∑ setdefault/update
```

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ `backtester/domain/portfolio_reset.py` - **–ù–û–í–´–ô** —Ñ–∞–π–ª
2. ‚úÖ `backtester/domain/position.py` - —É–ª—É—á—à–µ–Ω —Å helper-–º–µ—Ç–æ–¥–∞–º–∏
3. ‚úÖ `backtester/domain/portfolio.py` - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `simulate()` –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üß™ –¢–µ—Å—Ç—ã

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞.

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- `tests/portfolio/test_portfolio_runner_reset_portfolio_level.py` - portfolio-level reset
- `tests/portfolio/test_portfolio_runner_reset.py` - runner XN reset
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ `tests/portfolio/`

---

## üîç –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ

1. ‚úÖ **–ü–æ—Ç–µ—Ä—è reset-—Ñ–ª–∞–≥–æ–≤** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è meta —á–µ—Ä–µ–∑ `setdefault`/`update`
2. ‚úÖ **Reset –±–µ–∑ marker** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ `PortfolioResetContext`
3. ‚úÖ **Reset –±–µ–∑ closed_by_reset –ø–æ–∑–∏—Ü–∏–π** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `apply_portfolio_reset()`
4. ‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è reset_count** - —Ç–æ–ª—å–∫–æ –≤ `apply_portfolio_reset()`
5. ‚úÖ **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ reset-–ª–æ–≥–∏–∫–∏** - –µ–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —á–µ—Ä–µ–∑ `_apply_reset()`

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
2. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
3. ‚è≥ –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ debug-–º–µ—Ç–æ–¥—ã `_dbg()` –∏ `_dbg_meta()` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∫ –Ω–æ–≤—ã–º –∫–ª–∞—Å—Å–∞–º –∏ –º–µ—Ç–æ–¥–∞–º

---

## üéâ –ò—Ç–æ–≥–∏

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ v1.5 —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç–∞–ª–∞:
- ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ–π** - —á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ **–ß–∏—Ç–∞–µ–º–æ–π** - –º–µ–Ω—å—à–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö if-else, –±–æ–ª—å—à–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ–π** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã reset —á–µ—Ä–µ–∑ `ResetReason`
- ‚úÖ **–¢–µ—Å—Ç-–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–π** - –≤—Å–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–¥–∞

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫:
- ‚úÖ –ú–∞—Å—Å–æ–≤—ã–º –ø—Ä–æ–≥–æ–Ω–∞–º (6‚Äì12 –º–µ—Å—è—Ü–µ–≤, –º–∏–ª–ª–∏–æ–Ω—ã —Ç—Ä–µ–π–¥–æ–≤)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏—é –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚úÖ –î–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (Stage C, ML, —Ñ—Ä–æ–Ω—Ç)



