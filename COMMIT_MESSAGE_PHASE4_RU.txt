feat: Phase 4 - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–≥–æ —Å–ª–æ—è

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π, –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

1. –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫ (backtester/domain/portfolio.py)
   - –ï–¥–∏–Ω—ã–π –±–∞–ª–∞–Ω—Å –≤ SOL –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ/—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–π
   - –£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π (swap, LP, network) –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è (10% –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (max_exposure, max_open_positions)
   - Backtest window (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º)
   - Equity curve (–∫—Ä–∏–≤–∞—è –±–∞–ª–∞–Ω—Å–∞)

2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ BacktestRunner
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏
   - –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ YAML
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
   - –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã (CSV, JSON, –≥—Ä–∞—Ñ–∏–∫–∏)
   - Equity curve –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ Strategy-level –æ—Ç—á–µ—Ç–∞—Ö

üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- backtester/domain/portfolio.py (~330 —Å—Ç—Ä–æ–∫)
- docs/PORTFOLIO_LAYER.md
- docs/PNL_CALCULATION_EXPLANATION.md

üîß –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- backtester/domain/position.py (meta —Ç–µ–ø–µ—Ä—å field(default_factory=dict))
- backtester/application/runner.py (–¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã run_portfolio, _build_portfolio_config)
- backtester/infrastructure/reporter.py (–¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã save_portfolio_results, plot_portfolio_equity_curve)
- config/backtest_example.yaml (–¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—Ü–∏–∏ backtest –∏ portfolio)
- main.py (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—å–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏)
- CHANGELOG.md (–¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è Phase 4)

üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤:
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (–≤—ã—á–∏—Ç–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏, –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ backtest window

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ YAML
- –ü–æ–ª–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –ø–æ –ø–æ—Ä—Ç—Ñ–µ–ª—é
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

‚ö†Ô∏è –í–∞–∂–Ω–æ:
- Strategy-level Total PnL - —Å—É–º–º–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ (–Ω–µ —Ä–µ–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å)
- Portfolio-level Total return - —Ä–µ–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –î–ª—è –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Portfolio-level –æ—Ç—á–µ—Ç—ã!

üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- docs/PORTFOLIO_LAYER.md - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- docs/PNL_CALCULATION_EXPLANATION.md - –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–∏–π –≤ PnL
- CHANGELOG.md - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
